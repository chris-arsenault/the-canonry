[{"id": "apps/lore-weave/webui/src/hooks/useSimulationWorker.ts::useSimulationWorker", "name": "useSimulationWorker", "kind": "hook", "filePath": "apps/lore-weave/webui/src/hooks/useSimulationWorker.ts", "sourceCode": "export function useSimulationWorker(): UseSimulationWorkerReturn {\n  const [state, setState] = useState<SimulationState>(initialState);\n  const workerRef = useRef<Worker | null>(null);\n\n  // Cleanup worker on unmount\n  useEffect(() => {\n    return () => {\n      if (workerRef.current) {\n        workerRef.current.terminate();\n        workerRef.current = null;\n      }\n    };\n  }, []);\n\n  const handleMessage = useCallback((event: MessageEvent<SimulationEvent>) => {\n    const message = event.data;\n\n    setState((prev) => {\n      switch (message.type) {\n        case \"progress\":\n          // Map progress phase to status (includes 'paused')\n          const status = message.payload.phase as SimulationState[\"status\"];\n          return {\n            ...prev,\n            status,\n            progress: message.payload,\n          };\n\n        case \"log\":\n          // Limit log entries to prevent memory issues\n          const newLogs = [...prev.logs, message.payload];\n          if (newLogs.length > MAX_LOG_ENTRIES) {\n            newLogs.splice(0, newLogs.length - MAX_LOG_ENTRIES);\n          }\n          return {\n            ...prev,\n            logs: newLogs,\n          };\n\n        case \"validation\":\n          return {\n            ...prev,\n            validation: message.payload,\n          };\n\n        case \"epoch_start\":\n          return {\n            ...prev,\n            currentEpoch: message.payload,\n          };\n\n        case \"epoch_stats\":\n          return {\n            ...prev,\n            epochStats: [...prev.epochStats, message.payload],\n          };\n\n        case \"growth_phase\":\n          return {\n            ...prev,\n            growthPhases: [...prev.growthPhases, message.payload],\n          };\n\n        case \"template_application\":\n          // Keep only last 1000 template applications (for trace visualization)\n          const newTemplateApps = [...prev.templateApplications, message.payload];\n          if (newTemplateApps.length > 1000) {\n            newTemplateApps.splice(0, newTemplateApps.length - 1000);\n          }\n          return {\n            ...prev,\n            templateApplications: newTemplateApps,\n          };\n\n        case \"action_application\":\n          return {\n            ...prev,\n            actionApplications: [...prev.actionApplications, message.payload],\n          };\n\n        case \"pressure_update\":\n          // Keep only last 500 pressure updates (enough for ~33 epochs at 15 ticks each)\n          const newPressureUpdates = [...prev.pressureUpdates, message.payload];\n          if (newPressureUpdates.length > 500) {\n            newPressureUpdates.splice(0, newPressureUpdates.length - 500);\n          }\n          return {\n            ...prev,\n            pressureUpdates: newPressureUpdates,\n          };\n\n        case \"population_report\":\n          return {\n            ...prev,\n            populationReport: message.payload,\n          };\n\n        case \"template_usage\":\n          return {\n            ...prev,\n            templateUsage: message.payload,\n          };\n\n        case \"coordinate_stats\":\n          return {\n            ...prev,\n            coordinateStats: message.payload,\n          };\n\n        case \"tag_health\":\n          return {\n            ...prev,\n            tagHealth: message.payload,\n          };\n\n        case \"system_health\":\n          return {\n            ...prev,\n            systemHealth: message.payload,\n          };\n\n        case \"system_action\":\n          // Keep only last 500 system actions\n          const newSystemActions = [...prev.systemActions, message.payload];\n          if (newSystemActions.length > 500) {\n            newSystemActions.splice(0, newSystemActions.length - 500);\n          }\n          return {\n            ...prev,\n            systemActions: newSystemActions,\n          };\n\n        case \"entity_breakdown\":\n          return {\n            ...prev,\n            entityBreakdown: message.payload,\n          };\n\n        case \"catalyst_stats\":\n          return {\n            ...prev,\n            catalystStats: message.payload,\n          };\n\n        case \"relationship_breakdown\":\n          return {\n            ...prev,\n            relationshipBreakdown: message.payload,\n          };\n\n        case \"notable_entities\":\n          return {\n            ...prev,\n            notableEntities: message.payload,\n          };\n\n        case \"complete\":\n          return {\n            ...prev,\n            status: \"complete\",\n            result: message.payload,\n          };\n\n        case \"state_export\":\n          return {\n            ...prev,\n            stateExport: message.payload,\n          };\n\n        case \"error\":\n          return {\n            ...prev,\n            status: \"error\",\n            error: message.payload,\n          };\n\n        default:\n          return prev;\n      }\n    });\n  }, []);\n\n  const start = useCallback(\n    (config: EngineConfig, initialEntities: HardState[]) => {\n      // Terminate existing worker if any\n      if (workerRef.current) {\n        workerRef.current.terminate();\n      }\n\n      // Reset state to initial values\n      setState({\n        ...initialState,\n        status: \"initializing\",\n      });\n\n      // Create new worker using Vite's web worker support\n      // Import the worker as a module - Vite bundles it appropriately\n      workerRef.current = new Worker(new URL(\"../workers/simulation.worker.ts\", import.meta.url), {\n        type: \"module\",\n      });\n\n      workerRef.current.onmessage = handleMessage;\n\n      workerRef.current.onerror = (error) => {\n        setState((prev) => ({\n          ...prev,\n          status: \"error\",\n          error: {\n            message: error.message || \"Worker error\",\n            phase: \"worker\",\n            context: {},\n          },\n        }));\n      };\n\n      // Start simulation\n      workerRef.current.postMessage({\n        type: \"start\",\n        config,\n        initialState: initialEntities,\n      });\n    },\n    [handleMessage]\n  );\n\n  const startStepping = useCallback(\n    (config: EngineConfig, initialEntities: HardState[]) => {\n      // Terminate existing worker if any\n      if (workerRef.current) {\n        workerRef.current.terminate();\n      }\n\n      // Reset state to initial values\n      setState({\n        ...initialState,\n        status: \"initializing\",\n      });\n\n      // Create new worker\n      workerRef.current = new Worker(new URL(\"../workers/simulation.worker.ts\", import.meta.url), {\n        type: \"module\",\n      });\n\n      workerRef.current.onmessage = handleMessage;\n\n      workerRef.current.onerror = (error) => {\n        setState((prev) => ({\n          ...prev,\n          status: \"error\",\n          error: {\n            message: error.message || \"Worker error\",\n            phase: \"worker\",\n            context: {},\n          },\n        }));\n      };\n\n      // Initialize for stepping (doesn't run automatically)\n      workerRef.current.postMessage({\n        type: \"startStepping\",\n        config,\n        initialState: initialEntities,\n      });\n    },\n    [handleMessage]\n  );\n\n  const step = useCallback(() => {\n    if (workerRef.current) {\n      workerRef.current.postMessage({ type: \"step\" });\n    }\n  }, []);\n\n  const runToCompletion = useCallback(() => {\n    if (workerRef.current) {\n      workerRef.current.postMessage({ type: \"runToCompletion\" });\n    }\n  }, []);\n\n  const reset = useCallback(() => {\n    if (workerRef.current) {\n      // Reset state but keep worker\n      setState((prev) => ({\n        ...prev,\n        status: \"initializing\",\n        epochStats: [],\n        growthPhases: [],\n        pressureUpdates: [],\n        populationReport: null,\n        templateUsage: null,\n        coordinateStats: null,\n        tagHealth: null,\n        systemHealth: null,\n        systemActions: [],\n        entityBreakdown: null,\n        catalystStats: null,\n        relationshipBreakdown: null,\n        notableEntities: null,\n        result: null,\n        error: null,\n// ... (truncated)", "parameters": [], "returnType": "UseSimulationWorkerReturn", "jsxTree": null, "hookCalls": [{"name": "useState", "count": 1}, {"name": "useRef", "count": 1}, {"name": "useEffect", "count": 1}, {"name": "useCallback", "count": 9}], "imports": [{"source": "react", "specifiers": ["useState", "useCallback", "useRef", "useEffect"], "category": "framework"}, {"source": "../../../lib/observer/types", "specifiers": ["SimulationEvent", "ProgressPayload", "LogPayload", "ValidationPayload", "EpochStartPayload", "EpochStatsPayload", "GrowthPhasePayload", "TemplateApplicationPayload", "ActionApplicationPayload", "PressureUpdatePayload", "PopulationPayload", "TemplateUsagePayload", "CoordinateStatsPayload", "TagHealthPayload", "SystemHealthPayload", "SystemActionPayload", "EntityBreakdownPayload", "CatalystStatsPayload", "RelationshipBreakdownPayload", "NotableEntitiesPayload", "SimulationResultPayload", "StateExportPayload", "ErrorPayload"], "category": "internal"}, {"source": "../../../lib/engine/types", "specifiers": ["EngineConfig"], "category": "internal"}, {"source": "../../../lib/core/worldTypes", "specifiers": ["HardState"], "category": "internal"}], "storeAccess": []}, {"id": "apps/lore-weave/webui/src/components/config/index.js::ConfigurationSummary", "name": "ConfigurationSummary", "kind": "component", "filePath": "apps/lore-weave/webui/src/components/config/index.js", "sourceCode": "export default function ConfigurationSummary({\n  schema,\n  eras,\n  pressures,\n  generators,\n  seedEntities: _seedEntities,\n  seedRelationships: _seedRelationships,\n  validation,\n  onNavigateToRun,\n}) {\n  return (\n    <div className=\"lw-container\">\n      <div className=\"lw-header\">\n        <h1 className=\"lw-title\">Configuration Summary</h1>\n        <p className=\"lw-subtitle\">Review the world configuration before running the simulation</p>\n      </div>\n\n      {/* Validation Status */}\n      <div className={`lw-validation-box ${validation.isValid ? \"valid\" : \"invalid\"}`}>\n        <div className={`lw-validation-title ${validation.isValid ? \"valid\" : \"invalid\"}`}>\n          {validation.isValid ? \"Configuration is ready\" : \"Configuration incomplete\"}\n        </div>\n\n        {validation.issues.length > 0 && (\n          <ul className=\"lw-validation-list\">\n            {validation.issues.map((issue, i) => (\n              <li key={i} className=\"lw-validation-item error\">\n                {issue}\n              </li>\n            ))}\n          </ul>\n        )}\n\n        {validation.warnings.length > 0 && (\n          <ul\n            className={`lw-validation-list ${validation.issues.length > 0 ? \"cs-warning-list-spaced\" : \"\"}`}\n          >\n            {validation.warnings.map((warning, i) => (\n              <li key={i} className=\"lw-validation-item warning\">\n                {warning}\n              </li>\n            ))}\n          </ul>\n        )}\n      </div>\n\n      {/* Stats Overview */}\n      <div className=\"lw-stats-grid\">\n        <StatCard label=\"Entity Kinds\" value={validation.stats.entityKinds} />\n        <StatCard label=\"Relationship Kinds\" value={validation.stats.relationshipKinds} />\n        <StatCard label=\"Cultures\" value={validation.stats.cultures} />\n        <StatCard label=\"Eras\" value={validation.stats.eras} />\n        <StatCard label=\"Pressures\" value={validation.stats.pressures} />\n        <StatCard label=\"Generators\" value={validation.stats.generators} />\n        <StatCard label=\"Seed Entities\" value={validation.stats.seedEntities} />\n        <StatCard label=\"Seed Relationships\" value={validation.stats.seedRelationships} />\n      </div>\n\n      {/* Eras Detail */}\n      <div className=\"lw-section\">\n        <h2 className=\"lw-section-title\">Eras ({eras.length})</h2>\n        {eras.length === 0 ? (\n          <div className=\"lw-empty-state cs-empty-state-compact\">\n            No eras defined. Configure eras in the Coherence Engine tab.\n          </div>\n        ) : (\n          eras.map((era) => (\n            <div key={era.id} className=\"lw-detail-card\">\n              <div className=\"lw-detail-header\">\n                <span className=\"lw-detail-name\">{era.name || era.id}</span>\n                <span className=\"lw-detail-id\">{era.id}</span>\n              </div>\n              {era.summary && <div className=\"lw-detail-description\">{era.summary}</div>}\n            </div>\n          ))\n        )}\n      </div>\n\n      {/* Cultures */}\n      <div className=\"lw-section\">\n        <h2 className=\"lw-section-title\">Cultures ({schema.cultures.length})</h2>\n        {schema.cultures.length === 0 ? (\n          <div className=\"lw-empty-state cs-empty-state-compact\">\n            No cultures defined. Configure cultures in the Enumerist tab.\n          </div>\n        ) : (\n          <div className=\"lw-item-list\">\n            {schema.cultures.map((culture) => (\n              <span\n                key={culture.id}\n                className=\"lw-item-badge cs-culture-badge\"\n                style={{\n                  '--cs-culture-badge-border': culture.color || undefined,\n                  '--cs-culture-badge-color': culture.color || undefined,\n                }}\n              >\n                {culture.name}\n              </span>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Entity Kinds */}\n      <div className=\"lw-section\">\n        <h2 className=\"lw-section-title\">Entity Kinds ({schema.entityKinds.length})</h2>\n        {schema.entityKinds.length === 0 ? (\n          <div className=\"lw-empty-state cs-empty-state-compact\">\n            No entity kinds defined. Configure entity kinds in the Enumerist tab.\n          </div>\n        ) : (\n          <div className=\"lw-item-list\">\n            {schema.entityKinds.map((ek) => (\n              <span key={ek.kind || ek.id} className=\"lw-item-badge\">\n                {ek.name || ek.kind || ek.id}\n              </span>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Generators */}\n      <div className=\"lw-section\">\n        <h2 className=\"lw-section-title\">Generators ({generators.length})</h2>\n        {generators.length === 0 ? (\n          <div className=\"lw-empty-state cs-empty-state-compact\">\n            No generators defined. Configure generators in the Coherence Engine tab.\n          </div>\n        ) : (\n          <div className=\"lw-item-list\">\n            {generators.map((gen) => (\n              <span key={gen.id} className=\"lw-item-badge\">\n                {gen.name || gen.id}\n              </span>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Pressures */}\n      <div className=\"lw-section\">\n        <h2 className=\"lw-section-title\">Pressures ({pressures.length})</h2>\n        {pressures.length === 0 ? (\n          <div className=\"lw-empty-state cs-empty-state-compact\">\n            No pressures defined. Configure pressures in the Coherence Engine tab.\n          </div>\n        ) : (\n          <div className=\"lw-item-list\">\n            {pressures.map((pressure) => (\n              <span key={pressure.id} className=\"lw-item-badge\">\n                {pressure.name || pressure.id}\n              </span>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Run Button */}\n      <button\n        className={`lw-btn lw-btn-primary ${!validation.isValid ? \"disabled\" : \"\"}`}\n        onClick={onNavigateToRun}\n        disabled={!validation.isValid}\n      >\n        Continue to Run\n      </button>\n    </div>\n  );\n}", "parameters": [{"name": "{\n  schema,\n  eras,\n  pressures,\n  generators,\n  seedEntities: _seedEntities,\n  seedRelationships: _seedRelationships,\n  validation,\n  onNavigateToRun,\n}", "type": "{ schema: any; eras: any; pressures: any; generators: any; seedEntities: any; seedRelationships: any; validation: any; onNavigateToRun: any; }", "optional": false}], "returnType": "import(\"/home/tsonu/src/the-canonry/node_modules/.pnpm/@types+react@19.2.14/node_modules/@types/react/jsx-runtime\").JSX.Element", "jsxTree": {"tag": "div", "children": [{"tag": "div", "children": [{"tag": "h1", "children": [], "isMap": false, "isConditional": false}, {"tag": "p", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, {"tag": "div", "children": [{"tag": "div", "children": [], "isMap": false, "isConditional": false}, {"tag": "ul", "children": [{"tag": "li", "children": [], "isMap": true, "isConditional": false}], "isMap": false, "isConditional": true}, {"tag": "ul", "children": [{"tag": "li", "children": [], "isMap": true, "isConditional": false}], "isMap": false, "isConditional": true}], "isMap": false, "isConditional": false}, {"tag": "div", "children": [{"tag": "StatCard", "children": [], "isMap": false, "isConditional": false}, {"tag": "StatCard", "children": [], "isMap": false, "isConditional": false}, {"tag": "StatCard", "children": [], "isMap": false, "isConditional": false}, {"tag": "StatCard", "children": [], "isMap": false, "isConditional": false}, {"tag": "StatCard", "children": [], "isMap": false, "isConditional": false}, {"tag": "StatCard", "children": [], "isMap": false, "isConditional": false}, {"tag": "StatCard", "children": [], "isMap": false, "isConditional": false}, {"tag": "StatCard", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, {"tag": "div", "children": [{"tag": "h2", "children": [], "isMap": false, "isConditional": false}, {"tag": "div", "children": [], "isMap": false, "isConditional": true}], "isMap": false, "isConditional": false}, {"tag": "div", "children": [{"tag": "h2", "children": [], "isMap": false, "isConditional": false}, {"tag": "div", "children": [], "isMap": false, "isConditional": true}, {"tag": "div", "children": [{"tag": "span", "children": [], "isMap": true, "isConditional": false}], "isMap": false, "isConditional": true}], "isMap": false, "isConditional": false}, {"tag": "div", "children": [{"tag": "h2", "children": [], "isMap": false, "isConditional": false}, {"tag": "div", "children": [], "isMap": false, "isConditional": true}, {"tag": "div", "children": [{"tag": "span", "children": [], "isMap": true, "isConditional": false}], "isMap": false, "isConditional": true}], "isMap": false, "isConditional": false}, {"tag": "div", "children": [{"tag": "h2", "children": [], "isMap": false, "isConditional": false}, {"tag": "div", "children": [], "isMap": false, "isConditional": true}, {"tag": "div", "children": [{"tag": "span", "children": [], "isMap": true, "isConditional": false}], "isMap": false, "isConditional": true}], "isMap": false, "isConditional": false}, {"tag": "div", "children": [{"tag": "h2", "children": [], "isMap": false, "isConditional": false}, {"tag": "div", "children": [], "isMap": false, "isConditional": true}, {"tag": "div", "children": [{"tag": "span", "children": [], "isMap": true, "isConditional": false}], "isMap": false, "isConditional": true}], "isMap": false, "isConditional": false}, {"tag": "button", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, "hookCalls": [], "imports": [], "storeAccess": []}, {"id": "apps/lore-weave/webui/src/components/dashboard/index.js::SimulationDashboard", "name": "SimulationDashboard", "kind": "component", "filePath": "apps/lore-weave/webui/src/components/dashboard/index.js", "sourceCode": "export default function SimulationDashboard({ simState, onClearLogs }) {\n  const {\n    status,\n    progress,\n    currentEpoch,\n    epochStats,\n    pressureUpdates,\n    populationReport,\n    templateUsage,\n    systemHealth,\n    entityBreakdown,\n    catalystStats,\n    relationshipBreakdown,\n    notableEntities,\n    result,\n    logs,\n  } = simState;\n\n  // Extract pressures from latest epoch stats\n  const pressures = epochStats.length > 0 ? epochStats[epochStats.length - 1].pressures : null;\n\n  // Get the current epoch number\n  const currentEpochNumber =\n    currentEpoch?.epoch ?? (epochStats.length > 0 ? epochStats[epochStats.length - 1].epoch : 0);\n\n  // Aggregate all pressure updates for the current epoch\n  const aggregatedPressureUpdate = useMemo(\n    () => aggregatePressureUpdates(pressureUpdates, currentEpochNumber),\n    [pressureUpdates, currentEpochNumber]\n  );\n\n  const reachability = result?.metadata?.reachability;\n\n  // Show final diagnostics when simulation is complete or we have diagnostic data\n  const showFinalDiagnostics =\n    status === \"complete\" ||\n    entityBreakdown ||\n    catalystStats ||\n    relationshipBreakdown ||\n    notableEntities;\n\n  return (\n    <div className=\"lw-dashboard\">\n      {/* Overview Bar */}\n      <ProgressOverview progress={progress} status={status} />\n\n      {/* Main Content Grid */}\n      <div className=\"lw-main-content\">\n        {/* Left Panel */}\n        <EpochTimeline\n          epochStats={epochStats}\n          currentEpoch={currentEpoch}\n          pressures={pressures}\n          pressureDetails={aggregatedPressureUpdate}\n          reachability={reachability}\n        />\n\n        {/* Right Panel - stacked */}\n        <div className=\"lw-flex-col lw-gap-lg\">\n          <PopulationMetrics populationReport={populationReport} epochStats={epochStats} />\n          <TemplateUsage templateUsage={templateUsage} systemHealth={systemHealth} />\n        </div>\n      </div>\n\n      {/* Final Diagnostics (shown after completion) */}\n      {showFinalDiagnostics && (\n        <FinalDiagnostics\n          entityBreakdown={entityBreakdown}\n          catalystStats={catalystStats}\n          relationshipBreakdown={relationshipBreakdown}\n          notableEntities={notableEntities}\n        />\n      )}\n\n      {/* Log Stream */}\n      <LogStream logs={logs} onClear={onClearLogs} />\n    </div>\n  );\n}", "parameters": [{"name": "{ simState, onClearLogs }", "type": "{ simState: any; onClearLogs: any; }", "optional": false}], "returnType": "import(\"/home/tsonu/src/the-canonry/node_modules/.pnpm/@types+react@19.2.14/node_modules/@types/react/jsx-runtime\").JSX.Element", "jsxTree": {"tag": "div", "children": [{"tag": "ProgressOverview", "children": [], "isMap": false, "isConditional": false}, {"tag": "div", "children": [{"tag": "EpochTimeline", "children": [], "isMap": false, "isConditional": false}, {"tag": "div", "children": [{"tag": "PopulationMetrics", "children": [], "isMap": false, "isConditional": false}, {"tag": "TemplateUsage", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, {"tag": "FinalDiagnostics", "children": [], "isMap": false, "isConditional": true}, {"tag": "LogStream", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, "hookCalls": [{"name": "useMemo", "count": 1}], "imports": [], "storeAccess": []}, {"id": "apps/lore-weave/webui/src/components/dashboard/index.js::StatusBadge", "name": "StatusBadge", "kind": "component", "filePath": "apps/lore-weave/webui/src/components/dashboard/index.js", "sourceCode": "export default function StatusBadge({ status }) {\n  const config = STATUS_CONFIGS[status] || STATUS_CONFIGS.idle;\n\n  return (\n    <div className=\"lw-status-badge sb-badge\" style={{ '--sb-badge-bg': config.bg, '--sb-badge-color': config.color }}>\n      <span>{config.icon}</span>\n      <span>{config.label}</span>\n    </div>\n  );\n}", "parameters": [{"name": "{ status }", "type": "{ status: any; }", "optional": false}], "returnType": "import(\"/home/tsonu/src/the-canonry/node_modules/.pnpm/@types+react@19.2.14/node_modules/@types/react/jsx-runtime\").JSX.Element", "jsxTree": {"tag": "div", "children": [{"tag": "span", "children": [], "isMap": false, "isConditional": false}, {"tag": "span", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, "hookCalls": [], "imports": [], "storeAccess": []}, {"id": "apps/lore-weave/webui/src/components/dashboard/index.js::ProgressOverview", "name": "ProgressOverview", "kind": "component", "filePath": "apps/lore-weave/webui/src/components/dashboard/index.js", "sourceCode": "export default function ProgressOverview({ progress, status }) {\n  if (!progress) {\n    return (\n      <div className=\"lw-overview-bar\">\n        <StatusBadge status={status} />\n        <div className=\"lw-progress-section\">\n          <div className=\"lw-progress-bar\">\n            <div className=\"lw-progress-fill po-progress-fill\" style={{ '--po-progress-width': '0%' }} />\n          </div>\n          <div className=\"lw-progress-text\">\n            <span>Waiting to start...</span>\n            <span>0%</span>\n          </div>\n        </div>\n        <div className=\"lw-stats-row\">\n          <div className=\"lw-stat-item\">\n            <div className=\"lw-stat-value\">0</div>\n            <div className=\"lw-stat-label\">Entities</div>\n          </div>\n          <div className=\"lw-stat-item\">\n            <div className=\"lw-stat-value\">0</div>\n            <div className=\"lw-stat-label\">Relations</div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  // Progress based on completed epochs (0-100%)\n  const epochProgress =\n    progress.totalEpochs > 0 ? (progress.epoch / progress.totalEpochs) * 100 : 0;\n\n  let percent;\n  if (status === \"complete\") percent = 100;\n  else if (status === \"initializing\" || status === \"validating\") percent = 0;\n  else if (status === \"finalizing\") percent = 99;\n  else percent = Math.round(epochProgress);\n\n  return (\n    <div className=\"lw-overview-bar\">\n      <StatusBadge status={status} />\n      <div className=\"lw-progress-section\">\n        <div className=\"lw-progress-bar\">\n          <div className=\"lw-progress-fill po-progress-fill\" style={{ '--po-progress-width': `${percent}%` }} />\n        </div>\n        <div className=\"lw-progress-text\">\n          <span>\n            Tick {progress.tick} / {progress.maxTicks} \u2022 Epoch {progress.epoch} /{\" \"}\n            {progress.totalEpochs}\n          </span>\n          <span>{Math.round(percent)}%</span>\n        </div>\n      </div>\n      <div className=\"lw-stats-row\">\n        <div className=\"lw-stat-item\">\n          <div className=\"lw-stat-value\">{progress.entityCount.toLocaleString()}</div>\n          <div className=\"lw-stat-label\">Entities</div>\n        </div>\n        <div className=\"lw-stat-item\">\n          <div className=\"lw-stat-value\">{progress.relationshipCount.toLocaleString()}</div>\n          <div className=\"lw-stat-label\">Relations</div>\n        </div>\n      </div>\n    </div>\n  );\n}", "parameters": [{"name": "{ progress, status }", "type": "{ progress: any; status: any; }", "optional": false}], "returnType": "import(\"/home/tsonu/src/the-canonry/node_modules/.pnpm/@types+react@19.2.14/node_modules/@types/react/jsx-runtime\").JSX.Element", "jsxTree": {"tag": "div", "children": [{"tag": "StatusBadge", "children": [], "isMap": false, "isConditional": false}, {"tag": "div", "children": [{"tag": "div", "children": [{"tag": "div", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, {"tag": "div", "children": [{"tag": "span", "children": [], "isMap": false, "isConditional": false}, {"tag": "span", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, {"tag": "div", "children": [{"tag": "div", "children": [{"tag": "div", "children": [], "isMap": false, "isConditional": false}, {"tag": "div", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, {"tag": "div", "children": [{"tag": "div", "children": [], "isMap": false, "isConditional": false}, {"tag": "div", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, "hookCalls": [], "imports": [], "storeAccess": []}, {"id": "apps/lore-weave/webui/src/components/dashboard/index.js::EpochTimeline", "name": "EpochTimeline", "kind": "component", "filePath": "apps/lore-weave/webui/src/components/dashboard/index.js", "sourceCode": "export default function EpochTimeline({\n  epochStats,\n  currentEpoch,\n  pressures,\n  pressureDetails,\n  reachability,\n}) {\n  const recentEpochs = epochStats.slice(-5).reverse();\n\n  // Build a map of pressure details by ID for easy lookup\n  const detailsMap = new Map();\n  if (pressureDetails?.pressures) {\n    for (const p of pressureDetails.pressures) {\n      detailsMap.set(p.id, p);\n    }\n  }\n\n  const connectedComponents = reachability?.connectedComponents;\n  const fullyConnectedTick = reachability?.fullyConnectedTick ?? null;\n  const disconnectedClustersValue =\n    typeof connectedComponents === \"number\" ? connectedComponents.toLocaleString() : \"--\";\n  let fullyConnectedValue = \"--\";\n  if (reachability) {\n    fullyConnectedValue = fullyConnectedTick === null ? \"never\" : fullyConnectedTick.toLocaleString();\n  }\n  const clusterValueColor =\n    typeof connectedComponents === \"number\" && connectedComponents > 1\n      ? \"var(--lw-danger)\"\n      : undefined;\n\n  return (\n    <div className=\"lw-panel\">\n      <div className=\"lw-panel-header\">\n        <div className=\"lw-panel-title\">\n          <span>\u23f1</span>\n          Epoch Timeline\n        </div>\n        {currentEpoch && (\n          <span className=\"et-era-label\">\n            Era: {currentEpoch.era.name}\n          </span>\n        )}\n      </div>\n      <div className=\"lw-panel-content\">\n        {recentEpochs.length === 0 ? (\n          <div className=\"lw-empty-state\">\n            <span className=\"lw-empty-icon\">\u23f3</span>\n            <span>No epochs completed yet</span>\n          </div>\n        ) : (\n          <>\n            <div className=\"lw-timeline\">\n              {recentEpochs.map((epoch, i) => (\n                <div\n                  key={epoch.epoch}\n                  className={`lw-timeline-item ${i === 0 ? \"active\" : \"\"} et-timeline-opacity`}\n                  style={{ '--et-timeline-opacity': i === 0 ? 1 : 0.7 }}\n                >\n                  <div className={`lw-timeline-icon ${i === 0 ? \"active\" : \"\"}`}>{epoch.epoch}</div>\n                  <div className=\"lw-timeline-content\">\n                    <div className=\"lw-timeline-title\">{formatEpochEra(epoch.era)}</div>\n                    <div className=\"lw-timeline-subtitle\">\n                      +{epoch.entitiesCreated} entities \u2022 +{epoch.relationshipsCreated} relations\n                    </div>\n                  </div>\n                </div>\n              ))}\n            </div>\n\n            {/* Pressure Gauges with hover details */}\n            {pressures && Object.keys(pressures).length > 0 && (\n              <div className=\"et-section-spacer\">\n                <div className=\"et-section-label\">\n                  Current Pressures\n                  {pressureDetails && (\n                    <span className=\"et-section-label-hint\">\n                      (hover for epoch details\n                      {pressureDetails.ticksAggregated\n                        ? `, ${pressureDetails.ticksAggregated} ticks`\n                        : \"\"}\n                      )\n                    </span>\n                  )}\n                </div>\n                <div className=\"lw-flex-col lw-gap-sm\">\n                  {Object.entries(pressures).map(([name, value]) => (\n                    <PressureGauge\n                      key={name}\n                      name={name}\n                      value={value}\n                      detail={detailsMap.get(name)}\n                      discreteModifications={pressureDetails?.discreteModifications}\n                      tickCount={pressureDetails?.ticksAggregated}\n                    />\n                  ))}\n                </div>\n              </div>\n            )}\n\n            <div className=\"et-section-spacer\">\n              <div className=\"et-section-label\">\n                Graph Connectivity\n              </div>\n              <div className=\"lw-flex-col lw-gap-sm\">\n                <div className=\"et-metric-row\">\n                  <span>Disconnected clusters</span>\n                  <span className=\"et-cluster-value\" style={{ '--et-cluster-value-color': clusterValueColor }}>{disconnectedClustersValue}</span>\n                </div>\n                <div className=\"et-metric-row\">\n                  <span>Fully connected tick</span>\n                  <span className=\"et-connected-value\">{fullyConnectedValue}</span>\n                </div>\n              </div>\n            </div>\n          </>\n        )}\n      </div>\n    </div>\n  );\n}", "parameters": [{"name": "{\n  epochStats,\n  currentEpoch,\n  pressures,\n  pressureDetails,\n  reachability,\n}", "type": "{ epochStats: any; currentEpoch: any; pressures: any; pressureDetails: any; reachability: any; }", "optional": false}], "returnType": "import(\"/home/tsonu/src/the-canonry/node_modules/.pnpm/@types+react@19.2.14/node_modules/@types/react/jsx-runtime\").JSX.Element", "jsxTree": {"tag": "div", "children": [{"tag": "div", "children": [{"tag": "div", "children": [{"tag": "span", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, {"tag": "span", "children": [], "isMap": false, "isConditional": true}], "isMap": false, "isConditional": false}, {"tag": "div", "children": [{"tag": "div", "children": [{"tag": "span", "children": [], "isMap": false, "isConditional": false}, {"tag": "span", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": true}, {"tag": "<>", "children": [{"tag": "div", "children": [{"tag": "div", "children": [{"tag": "div", "children": [], "isMap": false, "isConditional": false}, {"tag": "div", "children": [{"tag": "div", "children": [], "isMap": false, "isConditional": false}, {"tag": "div", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}], "isMap": true, "isConditional": false}], "isMap": false, "isConditional": false}, {"tag": "div", "children": [{"tag": "div", "children": [{"tag": "span", "children": [], "isMap": false, "isConditional": true}], "isMap": false, "isConditional": false}, {"tag": "div", "children": [{"tag": "PressureGauge", "children": [], "isMap": true, "isConditional": false}], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": true}, {"tag": "div", "children": [{"tag": "div", "children": [], "isMap": false, "isConditional": false}, {"tag": "div", "children": [{"tag": "div", "children": [{"tag": "span", "children": [], "isMap": false, "isConditional": false}, {"tag": "span", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, {"tag": "div", "children": [{"tag": "span", "children": [], "isMap": false, "isConditional": false}, {"tag": "span", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": true}], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, "hookCalls": [], "imports": [], "storeAccess": []}, {"id": "apps/lore-weave/webui/src/components/dashboard/index.js::PopulationMetrics", "name": "PopulationMetrics", "kind": "component", "filePath": "apps/lore-weave/webui/src/components/dashboard/index.js", "sourceCode": "export default function PopulationMetrics({ populationReport, epochStats }) {\n  // Get latest epoch stats for entity breakdown\n  const latestEpoch = epochStats[epochStats.length - 1];\n\n  if (!populationReport && !latestEpoch) {\n    return (\n      <div className=\"lw-panel\">\n        <div className=\"lw-panel-header\">\n          <div className=\"lw-panel-title\">\n            <span>\ud83d\udcca</span>\n            Population Metrics\n          </div>\n        </div>\n        <div className=\"lw-panel-content\">\n          <div className=\"lw-empty-state\">\n            <span className=\"lw-empty-icon\">\ud83d\udcc8</span>\n            <span>Metrics will appear after first epoch</span>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"lw-panel\">\n      <div className=\"lw-panel-header\">\n        <div className=\"lw-panel-title\">\n          <span>\ud83d\udcca</span>\n          Population Metrics\n        </div>\n        {populationReport && (\n          <span\n            className=\"pm-deviation\"\n            style={{\n              '--pm-deviation-color': (() => {\n                if (populationReport.avgDeviation < 0.2) return \"var(--lw-success)\";\n                if (populationReport.avgDeviation < 0.4) return \"var(--lw-warning)\";\n                return \"var(--lw-danger)\";\n              })(),\n            }}\n          >\n            {(populationReport.avgDeviation * 100).toFixed(1)}% avg deviation\n          </span>\n        )}\n      </div>\n      <div className=\"lw-panel-content\">\n        {/* Entity counts by kind */}\n        {latestEpoch && (\n          <div className=\"lw-metric-grid\">\n            {Object.entries(latestEpoch.entitiesByKind).map(([kind, count]) => (\n              <div key={kind} className=\"lw-metric-card\">\n                <div className=\"lw-metric-header\">\n                  <span className=\"lw-metric-name\">{kind}</span>\n                </div>\n                <div className=\"lw-metric-value\">{count}</div>\n              </div>\n            ))}\n          </div>\n        )}\n\n        {/* Population deviations */}\n        {populationReport && populationReport.entityMetrics.length > 0 && (\n          <div className=\"pm-section-spacer\">\n            <div className=\"pm-section-label\">\n              Population Health\n            </div>\n            <div className=\"lw-flex-col lw-gap-sm\">\n              {populationReport.entityMetrics.slice(0, 6).map((metric) => {\n                const deviationPercent = Math.abs(metric.deviation * 100);\n                let color;\n                if (deviationPercent < 20) color = \"var(--lw-success)\";\n                else if (deviationPercent < 40) color = \"var(--lw-warning)\";\n                else color = \"var(--lw-danger)\";\n                return (\n                  <div key={`${metric.kind}:${metric.subtype}`} className=\"lw-pressure-gauge\">\n                    <span className=\"lw-pressure-name\">\n                      {metric.kind}:{metric.subtype}\n                    </span>\n                    <div className=\"lw-pressure-bar\">\n                      <div\n                        className=\"lw-pressure-fill pm-pressure-fill\"\n                        style={{\n                          '--pm-pressure-fill-width': `${Math.min(100, (metric.count / metric.target) * 50)}%`,\n                          '--pm-pressure-fill-color': color,\n                        }}\n                      />\n                    </div>\n                    <span className=\"lw-pressure-value pm-pressure-value\" style={{ '--pm-pressure-value-color': color }}>\n                      {metric.count}/{metric.target}\n                    </span>\n                  </div>\n                );\n              })}\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}", "parameters": [{"name": "{ populationReport, epochStats }", "type": "{ populationReport: any; epochStats: any; }", "optional": false}], "returnType": "import(\"/home/tsonu/src/the-canonry/node_modules/.pnpm/@types+react@19.2.14/node_modules/@types/react/jsx-runtime\").JSX.Element", "jsxTree": {"tag": "div", "children": [{"tag": "div", "children": [{"tag": "div", "children": [{"tag": "span", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, {"tag": "div", "children": [{"tag": "div", "children": [{"tag": "span", "children": [], "isMap": false, "isConditional": false}, {"tag": "span", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, "hookCalls": [], "imports": [], "storeAccess": []}, {"id": "apps/lore-weave/webui/src/components/dashboard/index.js::TemplateUsage", "name": "TemplateUsage", "kind": "component", "filePath": "apps/lore-weave/webui/src/components/dashboard/index.js", "sourceCode": "export default function TemplateUsage({ templateUsage, systemHealth }) {\n  const [showUnused, setShowUnused] = useState(false);\n\n  if (!templateUsage) {\n    return (\n      <div className=\"lw-panel\">\n        <div className=\"lw-panel-header\">\n          <div className=\"lw-panel-title\">\n            <span>\ud83d\udd27</span>\n            Template Usage\n          </div>\n        </div>\n        <div className=\"lw-panel-content\">\n          <div className=\"lw-empty-state\">\n            <span className=\"lw-empty-icon\">\u2699\ufe0f</span>\n            <span>Template stats will appear here</span>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  const maxCount = Math.max(...templateUsage.usage.map((t) => t.count), 1);\n  const unusedCount = templateUsage.unusedTemplates?.length || 0;\n\n  return (\n    <div className=\"lw-panel\">\n      <div className=\"lw-panel-header\">\n        <div className=\"lw-panel-title\">\n          <span>\ud83d\udd27</span>\n          Template Usage\n        </div>\n        <span className=\"tu-used-label\">\n          {templateUsage.uniqueTemplatesUsed}/{templateUsage.totalTemplates} used\n        </span>\n      </div>\n      <div className=\"lw-panel-content\">\n        {/* System health indicator */}\n        {systemHealth && (\n          <div className=\"lw-health-indicator tu-health-indicator\">\n            <div\n              className={`lw-health-dot ${systemHealth.status} tu-health-dot`}\n              style={{\n                '--tu-health-dot-bg': (() => {\n                  if (systemHealth.status === \"stable\") return \"var(--lw-success)\";\n                  if (systemHealth.status === \"functional\") return \"var(--lw-warning)\";\n                  return \"var(--lw-danger)\";\n                })(),\n              }}\n            />\n            <span className=\"lw-health-text\">\n              System Health: {(systemHealth.populationHealth * 100).toFixed(0)}%\n            </span>\n            <span className=\"tu-health-status\">\n              {systemHealth.status}\n            </span>\n          </div>\n        )}\n\n        {/* Top templates */}\n        <div className=\"lw-template-list\">\n          {templateUsage.usage.slice(0, 8).map((template) => {\n            let fillColor;\n            if (template.status === \"saturated\") fillColor = \"var(--lw-danger)\";\n            else if (template.status === \"warning\") fillColor = \"var(--lw-warning)\";\n            else fillColor = \"var(--lw-accent)\";\n            return (\n              <div key={template.templateId} className=\"lw-template-item\">\n                <span className=\"lw-template-name\" title={template.templateId}>\n                  {template.templateId}\n                </span>\n                <div className=\"lw-template-bar\">\n                  <div\n                    className=\"lw-template-fill tu-template-fill\"\n                    style={{\n                      '--tu-template-fill-width': `${(template.count / maxCount) * 100}%`,\n                      '--tu-template-fill-color': fillColor,\n                    }}\n                  />\n                </div>\n                <span className=\"lw-template-count\">{template.count}\u00d7</span>\n              </div>\n            );\n          })}\n        </div>\n\n        {/* Unused templates section */}\n        {unusedCount > 0 && (\n          <div className=\"lw-unused-section\">\n            <div className=\"lw-unused-header\" onClick={() => setShowUnused(!showUnused)} role=\"button\" tabIndex={0} onKeyDown={(e) => { if (e.key === \"Enter\" || e.key === \" \") e.currentTarget.click(); }} >\n              <span className=\"lw-unused-toggle\">{showUnused ? \"\u25bc\" : \"\u25b6\"}</span>\n              <span className=\"lw-unused-title\">Unused Templates ({unusedCount})</span>\n            </div>\n            {showUnused && (\n              <div className=\"lw-unused-list\">\n                {templateUsage.unusedTemplates.map((template) => (\n                  <UnusedTemplateItem key={template.templateId} template={template} />\n                ))}\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}", "parameters": [{"name": "{ templateUsage, systemHealth }", "type": "{ templateUsage: any; systemHealth: any; }", "optional": false}], "returnType": "import(\"/home/tsonu/src/the-canonry/node_modules/.pnpm/@types+react@19.2.14/node_modules/@types/react/jsx-runtime\").JSX.Element", "jsxTree": {"tag": "div", "children": [{"tag": "div", "children": [{"tag": "div", "children": [{"tag": "span", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, {"tag": "div", "children": [{"tag": "div", "children": [{"tag": "span", "children": [], "isMap": false, "isConditional": false}, {"tag": "span", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, "hookCalls": [{"name": "useState", "count": 1}], "imports": [], "storeAccess": []}, {"id": "apps/lore-weave/webui/src/components/dashboard/index.js::FinalDiagnostics", "name": "FinalDiagnostics", "kind": "component", "filePath": "apps/lore-weave/webui/src/components/dashboard/index.js", "sourceCode": "// Keep for JS template bar calculations\n\nexport default function FinalDiagnostics({\n  entityBreakdown,\n  catalystStats,\n  relationshipBreakdown,\n  notableEntities,\n}) {\n  const [activeTab, setActiveTab] = useState(\"entities\");\n\n  const hasDiagnostics =\n    entityBreakdown || catalystStats || relationshipBreakdown || notableEntities;\n\n  if (!hasDiagnostics) {\n    return null;\n  }\n\n  return (\n    <div className=\"lw-panel\">\n      <div className=\"lw-panel-header\">\n        <div className=\"lw-panel-title\">\n          <span>\ud83d\udccb</span>\n          Final Diagnostics\n        </div>\n      </div>\n\n      {/* Tab navigation */}\n      <div className=\"lw-filter-tabs\">\n        {[\"entities\", \"relationships\", \"agents\", \"notable\"].map((tab) => (\n          <button\n            key={tab}\n            className={`lw-filter-tab ${activeTab === tab ? \"active\" : \"\"}`}\n            onClick={() => setActiveTab(tab)}\n          >\n            {tab.charAt(0).toUpperCase() + tab.slice(1)}\n          </button>\n        ))}\n      </div>\n\n      <div className=\"lw-panel-content\">\n        {activeTab === \"entities\" && entityBreakdown && (\n          <EntityBreakdownTab entityBreakdown={entityBreakdown} />\n        )}\n        {activeTab === \"relationships\" && relationshipBreakdown && (\n          <RelationshipBreakdownTab relationshipBreakdown={relationshipBreakdown} />\n        )}\n        {activeTab === \"agents\" && catalystStats && <AgentsTab catalystStats={catalystStats} />}\n        {activeTab === \"notable\" && notableEntities && (\n          <NotableEntitiesTab notableEntities={notableEntities} />\n        )}\n      </div>\n    </div>\n  );\n}", "parameters": [{"name": "{\n  entityBreakdown,\n  catalystStats,\n  relationshipBreakdown,\n  notableEntities,\n}", "type": "{ entityBreakdown: any; catalystStats: any; relationshipBreakdown: any; notableEntities: any; }", "optional": false}], "returnType": "import(\"/home/tsonu/src/the-canonry/node_modules/.pnpm/@types+react@19.2.14/node_modules/@types/react/jsx-runtime\").JSX.Element", "jsxTree": {"tag": "div", "children": [{"tag": "div", "children": [{"tag": "div", "children": [{"tag": "span", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, {"tag": "div", "children": [{"tag": "button", "children": [], "isMap": true, "isConditional": false}], "isMap": false, "isConditional": false}, {"tag": "div", "children": [{"tag": "EntityBreakdownTab", "children": [], "isMap": false, "isConditional": true}, {"tag": "RelationshipBreakdownTab", "children": [], "isMap": false, "isConditional": true}, {"tag": "AgentsTab", "children": [], "isMap": false, "isConditional": true}, {"tag": "NotableEntitiesTab", "children": [], "isMap": false, "isConditional": true}], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, "hookCalls": [{"name": "useState", "count": 1}], "imports": [], "storeAccess": []}, {"id": "apps/lore-weave/webui/src/components/dashboard/index.js::LogStream", "name": "LogStream", "kind": "component", "filePath": "apps/lore-weave/webui/src/components/dashboard/index.js", "sourceCode": "export default function LogStream({ logs, onClear }) {\n  const [isExpanded, setIsExpanded] = useState(true);\n  const [filter, setFilter] = useState(\"all\");\n\n  const filteredLogs = useMemo(() => {\n    if (filter === \"all\") return logs;\n    return logs.filter((log) => log.level === filter);\n  }, [logs, filter]);\n\n  const logCounts = useMemo(\n    () => ({\n      all: logs.length,\n      info: logs.filter((l) => l.level === \"info\").length,\n      warn: logs.filter((l) => l.level === \"warn\").length,\n      error: logs.filter((l) => l.level === \"error\").length,\n    }),\n    [logs]\n  );\n\n  return (\n    <div className=\"lw-log-panel\">\n      <div className=\"lw-log-header\" onClick={() => setIsExpanded(!isExpanded)} role=\"button\" tabIndex={0} onKeyDown={(e) => { if (e.key === \"Enter\" || e.key === \" \") e.currentTarget.click(); }} >\n        <div className=\"ls-header-left\">\n          <span className=\"ls-title\">\n            {isExpanded ? \"\u25bc\" : \"\u25b6\"} Log Stream\n          </span>\n          <span className=\"ls-count\">\n            {logs.length} entries\n          </span>\n          {logCounts.error > 0 && (\n            <span className=\"lw-badge lw-badge-error\">{logCounts.error} errors</span>\n          )}\n          {logCounts.warn > 0 && (\n            <span className=\"lw-badge lw-badge-warn\">{logCounts.warn} warnings</span>\n          )}\n        </div>\n        {logs.length > 0 && (\n          <button\n            className=\"lw-btn-copy\"\n            onClick={(e) => {\n              e.stopPropagation();\n              onClear();\n            }}\n          >\n            Clear\n          </button>\n        )}\n      </div>\n      {isExpanded && logs.length > 0 && (\n        <>\n          <div className=\"ls-filter-bar\">\n            <div className=\"lw-filter-tabs\">\n              {[\"all\", \"info\", \"warn\", \"error\"].map((f) => (\n                <button\n                  key={f}\n                  className={`lw-filter-tab ${filter === f ? \"active\" : \"\"}`}\n                  onClick={() => setFilter(f)}\n                >\n                  {f} ({logCounts[f] || 0})\n                </button>\n              ))}\n            </div>\n          </div>\n          <div className=\"lw-log-content\">\n            {filteredLogs.slice(-100).map((log, i) => (\n              <div key={i} className={`lw-log-entry ${log.level}`}>\n                [{log.level.toUpperCase().padEnd(5)}] {log.message}\n              </div>\n            ))}\n          </div>\n        </>\n      )}\n    </div>\n  );\n}", "parameters": [{"name": "{ logs, onClear }", "type": "{ logs: any; onClear: any; }", "optional": false}], "returnType": "import(\"/home/tsonu/src/the-canonry/node_modules/.pnpm/@types+react@19.2.14/node_modules/@types/react/jsx-runtime\").JSX.Element", "jsxTree": {"tag": "div", "children": [{"tag": "div", "children": [{"tag": "div", "children": [{"tag": "span", "children": [], "isMap": false, "isConditional": false}, {"tag": "span", "children": [], "isMap": false, "isConditional": false}, {"tag": "span", "children": [], "isMap": false, "isConditional": true}, {"tag": "span", "children": [], "isMap": false, "isConditional": true}], "isMap": false, "isConditional": false}, {"tag": "button", "children": [], "isMap": false, "isConditional": true}], "isMap": false, "isConditional": false}, {"tag": "<>", "children": [{"tag": "div", "children": [{"tag": "div", "children": [{"tag": "button", "children": [], "isMap": true, "isConditional": false}], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, {"tag": "div", "children": [{"tag": "div", "children": [], "isMap": true, "isConditional": false}], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": true}], "isMap": false, "isConditional": false}, "hookCalls": [{"name": "useState", "count": 2}, {"name": "useMemo", "count": 2}], "imports": [], "storeAccess": []}, {"id": "apps/lore-weave/webui/src/components/results/index.js::ResultsViewer", "name": "ResultsViewer", "kind": "component", "filePath": "apps/lore-weave/webui/src/components/results/index.js", "sourceCode": "export default function ResultsViewer({ results, schema: _schema, onNewRun }) {\n  const [activeTab, setActiveTab] = useState(\"overview\");\n\n  // Process results for display\n  const processedData = useMemo(() => {\n    if (!results) return null;\n\n    const { metadata, hardState, relationships, pressures, engineConfig } = results;\n\n    // Group entities by kind\n    const entityGroups = {};\n    (hardState || []).forEach((entity) => {\n      const key = `${entity.kind}:${entity.subtype}`;\n      if (!entityGroups[key]) entityGroups[key] = [];\n      entityGroups[key].push(entity);\n    });\n\n    // Group relationships by kind\n    const relationshipGroups = {};\n    (relationships || []).forEach((rel) => {\n      if (!relationshipGroups[rel.kind]) relationshipGroups[rel.kind] = [];\n      relationshipGroups[rel.kind].push(rel);\n    });\n\n    return {\n      metadata,\n      entityGroups,\n      relationshipGroups,\n      pressures: pressures || {},\n      engineConfig,\n    };\n  }, [results]);\n\n  if (!results) {\n    return (\n      <div className=\"lw-container\">\n        <div className=\"lw-empty-state rv-empty-state\">\n          <div className=\"lw-empty-icon\"></div>\n          <div className=\"lw-empty-title\">No Results Yet</div>\n          <div className=\"lw-empty-text\">\n            Run a simulation to see the generated world history here. You can review the\n            configuration and adjust parameters before running.\n          </div>\n          <button className=\"lw-btn lw-btn-primary\" onClick={onNewRun}>\n            Go to Run\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  const exportResults = () => {\n    const blob = new Blob([JSON.stringify(results, null, 2)], { type: \"application/json\" });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement(\"a\");\n    a.href = url;\n    a.download = \"lore-weave-results.json\";\n    a.click();\n    URL.revokeObjectURL(url);\n  };\n\n  const exportConfig = () => {\n    const blob = new Blob([JSON.stringify(processedData.engineConfig, null, 2)], {\n      type: \"application/json\",\n    });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement(\"a\");\n    a.href = url;\n    a.download = \"engine-config.json\";\n    a.click();\n    URL.revokeObjectURL(url);\n  };\n\n  return (\n    <div className=\"lw-container\">\n      <div className=\"lw-header\">\n        <h1 className=\"lw-title\">Simulation Results</h1>\n        <p className=\"lw-subtitle\">\n          Generated world with {processedData.metadata?.entityCount || 0} entities and{\" \"}\n          {processedData.metadata?.relationshipCount || 0} relationships\n        </p>\n      </div>\n\n      {/* Action Buttons */}\n      <div className=\"lw-button-group rv-button-group\">\n        <button className=\"lw-btn lw-btn-secondary\" onClick={exportResults}>\n          Export Results\n        </button>\n        <button className=\"lw-btn lw-btn-secondary\" onClick={exportConfig}>\n          Export Config\n        </button>\n        <button className=\"lw-btn lw-btn-secondary\" onClick={onNewRun}>\n          Run New Simulation\n        </button>\n      </div>\n\n      {/* Stats Overview */}\n      <div className=\"lw-stats-grid\">\n        <StatCard label=\"Total Entities\" value={processedData.metadata?.entityCount || 0} />\n        <StatCard\n          label=\"Total Relationships\"\n          value={processedData.metadata?.relationshipCount || 0}\n        />\n        <StatCard label=\"Final Tick\" value={processedData.metadata?.tick || 0} />\n        <StatCard label=\"Epochs\" value={processedData.metadata?.epoch || 0} />\n        <StatCard label=\"Final Era\" value={processedData.metadata?.era || \"N/A\"} />\n      </div>\n\n      {/* Tabs */}\n      <div className=\"lw-tabs\">\n        <button\n          className={`lw-tab ${activeTab === \"overview\" ? \"active\" : \"\"}`}\n          onClick={() => setActiveTab(\"overview\")}\n        >\n          Overview\n        </button>\n        <button\n          className={`lw-tab ${activeTab === \"entities\" ? \"active\" : \"\"}`}\n          onClick={() => setActiveTab(\"entities\")}\n        >\n          Entities\n        </button>\n        <button\n          className={`lw-tab ${activeTab === \"pressures\" ? \"active\" : \"\"}`}\n          onClick={() => setActiveTab(\"pressures\")}\n        >\n          Pressures\n        </button>\n        <button\n          className={`lw-tab ${activeTab === \"config\" ? \"active\" : \"\"}`}\n          onClick={() => setActiveTab(\"config\")}\n        >\n          Config\n        </button>\n      </div>\n\n      {/* Tab Content */}\n      {activeTab === \"overview\" && (\n        <>\n          {/* Entity Groups */}\n          <div className=\"lw-card\">\n            <div className=\"lw-card-title\">\n              Entity Breakdown ({Object.keys(processedData.entityGroups).length} types)\n            </div>\n            <div className=\"lw-item-list\">\n              {Object.entries(processedData.entityGroups).map(([type, entities]) => (\n                <span key={type} className=\"lw-item-badge\">\n                  {type}: {entities.length}\n                </span>\n              ))}\n              {Object.keys(processedData.entityGroups).length === 0 && (\n                <span className=\"lw-comment\">No entities generated (mock run)</span>\n              )}\n            </div>\n          </div>\n\n          {/* Relationship Groups */}\n          <div className=\"lw-card\">\n            <div className=\"lw-card-title\">\n              Relationship Types ({Object.keys(processedData.relationshipGroups).length} kinds)\n            </div>\n            <div className=\"lw-item-list\">\n              {Object.entries(processedData.relationshipGroups).map(([kind, rels]) => (\n                <span key={kind} className=\"lw-item-badge\">\n                  {kind}: {rels.length}\n                </span>\n              ))}\n              {Object.keys(processedData.relationshipGroups).length === 0 && (\n                <span className=\"lw-comment\">No relationships generated (mock run)</span>\n              )}\n            </div>\n          </div>\n        </>\n      )}\n\n      {activeTab === \"entities\" && (\n        <div className=\"lw-card\">\n          <div className=\"lw-card-title\">Generated Entities</div>\n          {(results.hardState || []).length === 0 ? (\n            <div className=\"lw-comment\">\n              Entity generation is a mock in the current version. Run the CLI for actual entity\n              generation.\n            </div>\n          ) : (\n            <div className=\"lw-code-block\">{JSON.stringify(results.hardState, null, 2)}</div>\n          )}\n        </div>\n      )}\n\n      {activeTab === \"pressures\" && (\n        <div className=\"lw-card\">\n          <div className=\"lw-card-title\">Final Pressure States</div>\n          {Object.entries(processedData.pressures).length === 0 ? (\n            <div className=\"lw-comment\">No pressure data available</div>\n          ) : (\n            <div className=\"lw-flex-col lw-gap-md\">\n              {Object.entries(processedData.pressures).map(([name, value]) => (\n                <PressureBar key={name} name={name} value={value} />\n              ))}\n            </div>\n          )}\n        </div>\n      )}\n\n      {activeTab === \"config\" && (\n        <div className=\"lw-card\">\n          <div className=\"lw-card-title\">Engine Configuration Used</div>\n          <div className=\"lw-code-block\">{JSON.stringify(processedData.engineConfig, null, 2)}</div>\n        </div>\n      )}\n    </div>\n  );\n}", "parameters": [{"name": "{ results, schema: _schema, onNewRun }", "type": "{ results: any; schema: any; onNewRun: any; }", "optional": false}], "returnType": "import(\"/home/tsonu/src/the-canonry/node_modules/.pnpm/@types+react@19.2.14/node_modules/@types/react/jsx-runtime\").JSX.Element", "jsxTree": {"tag": "div", "children": [{"tag": "div", "children": [{"tag": "div", "children": [], "isMap": false, "isConditional": false}, {"tag": "div", "children": [], "isMap": false, "isConditional": false}, {"tag": "div", "children": [], "isMap": false, "isConditional": false}, {"tag": "button", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, "hookCalls": [{"name": "useState", "count": 1}, {"name": "useMemo", "count": 1}], "imports": [], "storeAccess": []}, {"id": "apps/lore-weave/webui/src/components/runner/index.js::SimulationRunner", "name": "SimulationRunner", "kind": "component", "filePath": "apps/lore-weave/webui/src/components/runner/index.js", "sourceCode": "export default function SimulationRunner({\n  projectId,\n  schema,\n  eras,\n  pressures,\n  generators,\n  systems,\n  actions,\n  seedEntities,\n  seedRelationships,\n  distributionTargets,\n  validation,\n  isRunning: _isRunning,\n  setIsRunning: _setIsRunning,\n  onComplete,\n  onViewResults,\n  onSearchRunScored,\n  externalSimulationState,\n  onSimulationStateChange,\n  simulationWorker,\n}) {\n  // Simulation parameters\n  const [params, setParams] = useState({\n    scaleFactor: 1.0,\n    defaultMinDistance: 5,\n    pressureDeltaSmoothing: 10,\n    ticksPerEpoch: 20,\n    maxEpochs: 14,\n    maxTicks: 500,\n    // Narrative event tracking\n    narrativeEnabled: true,\n    narrativeMinSignificance: 0,\n    // Validity search\n    maxValidityAttempts: 4,\n  });\n\n  // Debug configuration\n  const [debugConfig, setDebugConfig] = useState({\n    enabled: false,\n    enabledCategories: [],\n  });\n  const debugModalKey = projectId\n    ? `${DEBUG_MODAL_PREFIX}${projectId}`\n    : `${DEBUG_MODAL_PREFIX}global`;\n  const [showDebugModal, setShowDebugModal] = useState(() => loadStoredBoolean(debugModalKey));\n\n  useEffect(() => {\n    setShowDebugModal(loadStoredBoolean(debugModalKey));\n  }, [debugModalKey]);\n\n  useEffect(() => {\n    saveStoredBoolean(debugModalKey, showDebugModal);\n  }, [debugModalKey, showDebugModal]);\n\n  // Use simulation worker passed from parent\n  const {\n    state: workerSimState,\n    start: startWorker,\n    startStepping: startSteppingWorker,\n    step: stepWorker,\n    runToCompletion: runToCompletionWorker,\n    reset: resetWorker,\n    abort: abortWorker,\n    clearLogs: workerClearLogs,\n    isRunning: workerIsRunning,\n    isPaused: workerIsPaused,\n  } = simulationWorker;\n\n  // Use external state if provided and worker is idle\n  const simState =\n    workerSimState.status === \"idle\" && externalSimulationState\n      ? externalSimulationState\n      : workerSimState;\n\n  // Sync worker state changes to external state\n  const prevStatusRef = React.useRef(workerSimState.status);\n  useEffect(() => {\n    if (onSimulationStateChange && workerSimState.status !== \"idle\") {\n      if (prevStatusRef.current !== workerSimState.status) {\n        prevStatusRef.current = workerSimState.status;\n        onSimulationStateChange(workerSimState);\n      }\n    }\n  }, [workerSimState.status, onSimulationStateChange]);\n\n  // Wrap clearLogs to also clear external state\n  const clearLogs = useCallback(() => {\n    workerClearLogs();\n    if (onSimulationStateChange && externalSimulationState) {\n      onSimulationStateChange({ ...externalSimulationState, logs: [] });\n    }\n  }, [workerClearLogs, onSimulationStateChange, externalSimulationState]);\n\n  // Handle completion\n  useEffect(() => {\n    if (simState.status === \"complete\" && simState.result) {\n      onComplete(simState.result);\n    }\n  }, [simState.status, simState.result, onComplete]);\n\n  // Run scoring: templates fired (high), actions completed (med), systems executed (low)\n  const runValidity = useMemo(() => {\n    if (simState.status !== \"complete\") {\n      return {\n        score: 0,\n        maxScore: 0,\n        scoreBreakdown: null,\n        reachedFinalEra: false,\n        unusedSystems: [],\n      };\n    }\n\n    const totalTemplates = simState.templateUsage?.totalTemplates ?? countEnabled(generators);\n    const unusedTemplates = simState.templateUsage?.unusedTemplates || [];\n    const templatesUsed = Math.max(totalTemplates - unusedTemplates.length, 0);\n\n    const totalActions = countEnabled(actions);\n    const unusedActions = simState.catalystStats?.unusedActions || [];\n    const actionsUsed = Math.max(totalActions - unusedActions.length, 0);\n\n    // Check systems fired (derived from narrativeHistory)\n    const unusedSystems = getUnusedSystems(simState.result?.narrativeHistory, systems);\n    const totalSystems = (systems || [])\n      .filter((s) => s.enabled !== false)\n      .map((s) => s.config?.id || s.systemType)\n      .filter((id) => id && !INFRASTRUCTURE_SYSTEMS.has(id)).length;\n    const systemsUsed = Math.max(totalSystems - unusedSystems.length, 0);\n\n    // Check if we reached the final era\n    // The final era is the last one in the eras array\n    const finalEraId = eras?.length > 0 ? eras[eras.length - 1].id : null;\n    const currentEraId = simState.currentEpoch?.era?.id;\n    const reachedFinalEra = finalEraId && currentEraId === finalEraId;\n\n    const score =\n      templatesUsed * RUN_SCORE_WEIGHTS.templates +\n      actionsUsed * RUN_SCORE_WEIGHTS.actions +\n      systemsUsed * RUN_SCORE_WEIGHTS.systems;\n    const maxScore =\n      totalTemplates * RUN_SCORE_WEIGHTS.templates +\n      totalActions * RUN_SCORE_WEIGHTS.actions +\n      totalSystems * RUN_SCORE_WEIGHTS.systems;\n\n    return {\n      score,\n      maxScore,\n      scoreBreakdown: {\n        templates: {\n          used: templatesUsed,\n          total: totalTemplates,\n          weight: RUN_SCORE_WEIGHTS.templates,\n        },\n        actions: {\n          used: actionsUsed,\n          total: totalActions,\n          weight: RUN_SCORE_WEIGHTS.actions,\n        },\n        systems: {\n          used: systemsUsed,\n          total: totalSystems,\n          weight: RUN_SCORE_WEIGHTS.systems,\n        },\n      },\n      unusedSystems,\n      reachedFinalEra,\n    };\n  }, [\n    simState.status,\n    simState.templateUsage,\n    simState.catalystStats,\n    simState.result,\n    simState.currentEpoch,\n    eras,\n    systems,\n    generators,\n    actions,\n  ]);\n\n  // Run Until Valid state\n  const [validityAttempts, setValidityAttempts] = useState(0);\n  const [isRunningUntilValid, setIsRunningUntilValid] = useState(false);\n  const runUntilValidRef = useRef(false);\n\n  // Store run data for validity search analysis\n  const [validityRunData, setValidityRunData] = useState([]);\n  const [validitySearchComplete, setValiditySearchComplete] = useState(false);\n\n  // Generate the EngineConfig\n  const engineConfig = useMemo(() => {\n    return {\n      schema,\n      eras,\n      pressures: pressures,\n      templates: (generators || []).filter((g) => g.enabled !== false),\n      systems: (systems || []).filter((s) => s.enabled !== false),\n      actions: (actions || []).filter((a) => a.enabled !== false),\n      ticksPerEpoch: params.ticksPerEpoch,\n      maxEpochs: params.maxEpochs,\n      maxTicks: params.maxTicks,\n      maxRelationshipsPerType: 10,\n      scaleFactor: params.scaleFactor,\n      defaultMinDistance: params.defaultMinDistance,\n      pressureDeltaSmoothing: params.pressureDeltaSmoothing,\n      seedRelationships: seedRelationships || [],\n      distributionTargets: distributionTargets || undefined,\n      debugConfig,\n      // Narrative event tracking config\n      narrativeConfig: {\n        enabled: params.narrativeEnabled,\n        minSignificance: params.narrativeMinSignificance,\n      },\n    };\n  }, [\n    schema,\n    eras,\n    pressures,\n    generators,\n    systems,\n    actions,\n    params,\n    seedRelationships,\n    distributionTargets,\n    debugConfig,\n  ]);\n\n  // Run simulation\n  const runSimulation = useCallback(() => {\n    if (!validation.isValid) return;\n\n    const initialEntities = seedEntities || [];\n    startWorker(engineConfig, initialEntities);\n  }, [validation, engineConfig, seedEntities, startWorker]);\n\n  // Start in step mode\n  const startStepMode = useCallback(() => {\n    if (!validation.isValid) return;\n\n    const initialEntities = seedEntities || [];\n    startSteppingWorker(engineConfig, initialEntities);\n  }, [validation, engineConfig, seedEntities, startSteppingWorker]);\n\n  // Run Until Valid handler\n  const runUntilValid = useCallback(() => {\n    if (!validation.isValid) return;\n\n    runUntilValidRef.current = true;\n    setIsRunningUntilValid(true);\n    setValidityAttempts(1);\n    setValidityRunData([]); // Clear previous run data\n    setValiditySearchComplete(false);\n\n    const initialEntities = seedEntities || [];\n    startWorker(engineConfig, initialEntities);\n  }, [validation, engineConfig, seedEntities, startWorker]);\n\n  // Cancel run until valid\n  const cancelRunUntilValid = useCallback(() => {\n    runUntilValidRef.current = false;\n    setIsRunningUntilValid(false);\n    setValiditySearchComplete(false);\n    abortWorker();\n  }, [abortWorker]);\n\n  // Effect to handle \"run until valid\" loop and store run data\n  useEffect(() => {\n    if (!runUntilValidRef.current) return;\n    if (simState.status !== \"complete\") return;\n    if (!simState.result) return; // Wait for result to be fully populated\n\n    // Store this run's data for analysis - match canonry-slot export format\n    const runData = {\n      attempt: validityAttempts,\n      runScore: runValidity.score,\n      runScoreMax: runValidity.maxScore,\n      runScoreDetails: runValidity.scoreBreakdown,\n      finalEra: simState.currentEpoch?.era?.id || \"unknown\",\n      finalEraName: simState.currentEpoch?.era?.name || \"Unknown\",\n      reachedFinalEra: runValidity.reachedFinalEra,\n      unusedTemplates: simState.templateUsage?.unusedTemplates?.map((t) => t.templateId) || [],\n      unusedActions: simState.catalystStats?.unusedActions?.map((a) => a.actionId) || [],\n      unusedSystems: runValidity.unusedSystems || [],\n      entityCount: simState.result?.hardState?.length || 0,\n      relationshipCount: simState.result?.relationships?.length || 0,\n      // Store in canonry-slot format for script compatibility\n      simulationResults: simState.result,\n      simulationState: simState,\n    };\n\n    setValidityRunData((prev) => [...prev, runData]);\n    if (onSearchRunScored) {\n      onSearchRunScored({\n        attempt: runData.attempt,\n        runScore: runData.runScore,\n        runScoreMax: runData.runScoreMax,\n        runScoreDetails: runData.runScoreDetails,\n        simulationResults: runData.simulationResults,\n        simulationState: runData.simulationState,\n      });\n    }\n\n// ... (truncated)", "parameters": [{"name": "{\n  projectId,\n  schema,\n  eras,\n  pressures,\n  generators,\n  systems,\n  actions,\n  seedEntities,\n  seedRelationships,\n  distributionTargets,\n  validation,\n  isRunning: _isRunning,\n  setIsRunning: _setIsRunning,\n  onComplete,\n  onViewResults,\n  onSearchRunScored,\n  externalSimulationState,\n  onSimulationStateChange,\n  simulationWorker,\n}", "type": "{ projectId: any; schema: any; eras: any; pressures: any; generators: any; systems: any; actions: any; seedEntities: any; seedRelationships: any; distributionTargets: any; validation: any; isRunning: any; setIsRunning: any; onComplete: any; onViewResults: any; onSearchRunScored: any; externalSimulationState: any; onSimulationStateChange: any; simulationWorker: any; }", "optional": false}], "returnType": "import(\"/home/tsonu/src/the-canonry/node_modules/.pnpm/@types+react@19.2.14/node_modules/@types/react/jsx-runtime\").JSX.Element", "jsxTree": {"tag": "div", "children": [{"tag": "div", "children": [{"tag": "h1", "children": [], "isMap": false, "isConditional": false}, {"tag": "p", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, {"tag": "div", "children": [], "isMap": false, "isConditional": true}, {"tag": "div", "children": [{"tag": "strong", "children": [], "isMap": false, "isConditional": false}, {"tag": "span", "children": [], "isMap": false, "isConditional": true}], "isMap": false, "isConditional": true}, {"tag": "div", "children": [{"tag": "div", "children": [{"tag": "div", "children": [], "isMap": false, "isConditional": false}, {"tag": "div", "children": [{"tag": "RunControls", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, {"tag": "ParameterForm", "children": [], "isMap": false, "isConditional": true}, {"tag": "ConfigViewer", "children": [], "isMap": false, "isConditional": true}], "isMap": false, "isConditional": false}, {"tag": "SimulationDashboard", "children": [], "isMap": false, "isConditional": true}, {"tag": "DebugSettingsModal", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, "hookCalls": [{"name": "useState", "count": 7}, {"name": "useEffect", "count": 5}, {"name": "useRef", "count": 2}, {"name": "useCallback", "count": 6}, {"name": "useMemo", "count": 3}], "imports": [], "storeAccess": []}, {"id": "apps/lore-weave/webui/src/components/runner/index.js::ParameterForm", "name": "ParameterForm", "kind": "component", "filePath": "apps/lore-weave/webui/src/components/runner/index.js", "sourceCode": "export default function ParameterForm({ params, onParamChange }) {\n  return (\n    <div className=\"lw-form-grid\">\n      <div className=\"lw-form-group\">\n        <label className=\"lw-label\">Scale Factor\n        <NumberInput\n          min={0.1}\n          max={10}\n          step={0.1}\n          value={params.scaleFactor}\n          onChange={(v) => onParamChange(\"scaleFactor\", v ?? 1)}\n          className=\"lw-input\"\n        />\n        </label>\n      </div>\n      <div className=\"lw-form-group\">\n        <label className=\"lw-label\">Default Min Distance\n        <NumberInput\n          min={1}\n          max={20}\n          step={0.5}\n          value={params.defaultMinDistance}\n          onChange={(v) => onParamChange(\"defaultMinDistance\", v ?? 5)}\n          className=\"lw-input\"\n          title=\"Minimum distance between entities on semantic planes\"\n        />\n        </label>\n      </div>\n      <div className=\"lw-form-group\">\n        <label className=\"lw-label\">Pressure Smoothing\n        <NumberInput\n          min={1}\n          max={50}\n          step={1}\n          value={params.pressureDeltaSmoothing}\n          onChange={(v) => onParamChange(\"pressureDeltaSmoothing\", v ?? 10)}\n          className=\"lw-input\"\n          integer\n          title=\"Max pressure change per tick from feedback (higher = faster swings)\"\n        />\n        </label>\n      </div>\n      <div className=\"lw-form-group\">\n        <label className=\"lw-label\">Ticks Per Epoch\n        <NumberInput\n          min={1}\n          max={50}\n          value={params.ticksPerEpoch}\n          onChange={(v) => onParamChange(\"ticksPerEpoch\", v ?? 20)}\n          className=\"lw-input\"\n          integer\n          title=\"Number of simulation ticks to run per epoch\"\n        />\n        </label>\n      </div>\n      <div className=\"lw-form-group\">\n        <label className=\"lw-label\">Max Epochs\n        <NumberInput\n          min={1}\n          max={100}\n          value={params.maxEpochs}\n          onChange={(v) => onParamChange(\"maxEpochs\", v ?? 14)}\n          className=\"lw-input\"\n          integer\n          title=\"Maximum epochs to run (hard limit on simulation length)\"\n        />\n        </label>\n      </div>\n      <div className=\"lw-form-group\">\n        <label className=\"lw-label\">Max Ticks\n        <NumberInput\n          min={100}\n          max={5000}\n          value={params.maxTicks}\n          onChange={(v) => onParamChange(\"maxTicks\", v ?? 500)}\n          className=\"lw-input\"\n          integer\n        />\n        </label>\n      </div>\n      <div className=\"lw-form-group\">\n        <label className=\"lw-label\">Validity Attempts\n        <NumberInput\n          min={1}\n          max={20}\n          value={params.maxValidityAttempts}\n          onChange={(v) => onParamChange(\"maxValidityAttempts\", v ?? 4)}\n          className=\"lw-input\"\n          integer\n          title=\"Max runs for 'Until Valid' search\"\n        />\n        </label>\n      </div>\n\n      {/* Narrative Events Section */}\n      <div className=\"lw-form-group pf-narrative-section\">\n        <div className=\"pf-narrative-header\">\n          <span className=\"lw-label pf-narrative-label\">\n            Narrative Events\n          </span>\n          <label className=\"pf-toggle-label\">\n            <input\n              type=\"checkbox\"\n              checked={params.narrativeEnabled ?? false}\n              onChange={(e) => onParamChange(\"narrativeEnabled\", e.target.checked)}\n              className=\"pf-toggle-checkbox\"\n            />\n            Enable event tracking\n          </label>\n        </div>\n        <p className=\"pf-narrative-desc\">\n          Captures significant world changes (status, prominence, relationships) as narrative events\n          for story generation.\n        </p>\n        {params.narrativeEnabled && (\n          <div className=\"pf-narrative-fields\">\n            <div className=\"lw-form-group pf-narrative-field\">\n              <label className=\"lw-label\">Min Significance\n              <NumberInput\n                min={0}\n                max={1}\n                step={0.1}\n                value={params.narrativeMinSignificance ?? 0}\n                onChange={(v) => onParamChange(\"narrativeMinSignificance\", v ?? 0)}\n                className=\"lw-input\"\n                title=\"Minimum significance threshold (0-1). Higher = fewer, more important events.\"\n              />\n              </label>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}", "parameters": [{"name": "{ params, onParamChange }", "type": "{ params: any; onParamChange: any; }", "optional": false}], "returnType": "import(\"/home/tsonu/src/the-canonry/node_modules/.pnpm/@types+react@19.2.14/node_modules/@types/react/jsx-runtime\").JSX.Element", "jsxTree": {"tag": "div", "children": [{"tag": "div", "children": [{"tag": "label", "children": [{"tag": "NumberInput", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, {"tag": "div", "children": [{"tag": "label", "children": [{"tag": "NumberInput", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, {"tag": "div", "children": [{"tag": "label", "children": [{"tag": "NumberInput", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, {"tag": "div", "children": [{"tag": "label", "children": [{"tag": "NumberInput", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, {"tag": "div", "children": [{"tag": "label", "children": [{"tag": "NumberInput", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, {"tag": "div", "children": [{"tag": "label", "children": [{"tag": "NumberInput", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, {"tag": "div", "children": [{"tag": "label", "children": [{"tag": "NumberInput", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, {"tag": "div", "children": [{"tag": "div", "children": [{"tag": "span", "children": [], "isMap": false, "isConditional": false}, {"tag": "label", "children": [{"tag": "input", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, {"tag": "p", "children": [], "isMap": false, "isConditional": false}, {"tag": "div", "children": [{"tag": "div", "children": [{"tag": "label", "children": [{"tag": "NumberInput", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": true}], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, "hookCalls": [], "imports": [], "storeAccess": []}, {"id": "apps/lore-weave/webui/src/components/runner/index.js::RunControls", "name": "RunControls", "kind": "component", "filePath": "apps/lore-weave/webui/src/components/runner/index.js", "sourceCode": "export default function RunControls({\n  isRunning,\n  isPaused,\n  simState,\n  validation,\n  runValidity,\n  isRunningUntilValid,\n  validityAttempts,\n  maxValidityAttempts,\n  validitySearchComplete,\n  validityReport,\n  onRun,\n  onRunUntilValid,\n  onCancelRunUntilValid,\n  onDownloadValidityData,\n  onStartStepMode,\n  onStep,\n  onRunToCompletion,\n  onAbort,\n  onReset,\n  onViewResults,\n}) {\n  // Running until valid - show special stop button\n  if (isRunningUntilValid && isRunning) {\n    return (\n      <>\n        <div className=\"lw-step-indicator\">\n          <span>\n            Attempt {validityAttempts} / {maxValidityAttempts}\n          </span>\n          <span className=\"rc-searching-label\">SEARCHING FOR BEST RUN</span>\n        </div>\n        <button className=\"lw-btn lw-btn-danger\" onClick={onCancelRunUntilValid}>\n          \u25fc Cancel\n        </button>\n      </>\n    );\n  }\n\n  if (isRunning && !isPaused) {\n    // Running state - show stop button\n    return (\n      <button className=\"lw-btn lw-btn-danger\" onClick={onAbort}>\n        \u25fc Stop\n      </button>\n    );\n  }\n\n  if (isPaused) {\n    // Paused state - show step controls\n    return (\n      <>\n        <div className=\"lw-step-indicator\">\n          <span>\n            Epoch {simState.progress?.epoch || 0} / {simState.progress?.totalEpochs || 0}\n          </span>\n          <span className=\"rc-paused-label\">PAUSED</span>\n        </div>\n        <div className=\"lw-button-group\">\n          <button className=\"lw-btn lw-btn-step\" onClick={onStep}>\n            \u23ed Next Epoch\n          </button>\n          <button\n            className=\"lw-btn lw-btn-primary\"\n            onClick={onRunToCompletion}\n            title=\"Continue running all remaining epochs\"\n          >\n            \u25b6 Continue\n          </button>\n          <button className=\"lw-btn lw-btn-reset\" onClick={onReset}>\n            \u21bb Reset\n          </button>\n        </div>\n        {simState.status === \"complete\" && onViewResults && (\n          <button className=\"lw-btn lw-btn-success\" onClick={onViewResults}>\n            \u2713 View Results\n          </button>\n        )}\n      </>\n    );\n  }\n\n  // Idle or complete state - show run/step buttons\n  return (\n    <>\n      {simState.status === \"complete\" && <ValidityBadge runValidity={runValidity} />}\n      {validitySearchComplete && validityReport && (\n        <span\n          className=\"lw-validity-badge rc-badge-search\"\n          title={`Best score ${validityReport.summary.bestScore}${validityReport.summary.bestScoreMax ? \"/\" + validityReport.summary.bestScoreMax : \"\"} on attempt ${validityReport.summary.bestAttempt}`}\n        >\n          {validityReport.summary.totalAttempts} runs\n        </span>\n      )}\n      <div className=\"lw-button-group\">\n        <button\n          className={`lw-btn lw-btn-primary ${!validation.isValid ? \"disabled\" : \"\"}`}\n          onClick={onRun}\n          disabled={!validation.isValid}\n        >\n          \u25b6 Run\n        </button>\n        <button\n          className={`lw-btn lw-btn-secondary ${!validation.isValid ? \"disabled\" : \"\"}`}\n          onClick={onRunUntilValid}\n          disabled={!validation.isValid}\n          title={`Run up to ${maxValidityAttempts} simulations and keep the highest score`}\n        >\n          \u27f3 Search\n        </button>\n        <button\n          className={`lw-btn lw-btn-step ${!validation.isValid ? \"disabled\" : \"\"}`}\n          onClick={onStartStepMode}\n          disabled={!validation.isValid}\n          title=\"Run one epoch at a time\"\n        >\n          \u23ef Step\n        </button>\n      </div>\n      {validitySearchComplete && validityReport && (\n        <button\n          className=\"lw-btn lw-btn-secondary\"\n          onClick={onDownloadValidityData}\n          title=\"Download all run data and analysis report as ZIP\"\n        >\n          \u2b07 Download Runs\n        </button>\n      )}\n      {simState.status === \"complete\" && onViewResults && (\n        <button className=\"lw-btn lw-btn-success\" onClick={onViewResults}>\n          \u2713 View Results\n        </button>\n      )}\n    </>\n  );\n}", "parameters": [{"name": "{\n  isRunning,\n  isPaused,\n  simState,\n  validation,\n  runValidity,\n  isRunningUntilValid,\n  validityAttempts,\n  maxValidityAttempts,\n  validitySearchComplete,\n  validityReport,\n  onRun,\n  onRunUntilValid,\n  onCancelRunUntilValid,\n  onDownloadValidityData,\n  onStartStepMode,\n  onStep,\n  onRunToCompletion,\n  onAbort,\n  onReset,\n  onViewResults,\n}", "type": "{ isRunning: any; isPaused: any; simState: any; validation: any; runValidity: any; isRunningUntilValid: any; validityAttempts: any; maxValidityAttempts: any; validitySearchComplete: any; validityReport: any; onRun: any; onRunUntilValid: any; onCancelRunUntilValid: any; onDownloadValidityData: any; onStartStepMode: any; onStep: any; onRunToCompletion: any; onAbort: any; onReset: any; onViewResults: any; }", "optional": false}], "returnType": "import(\"/home/tsonu/src/the-canonry/node_modules/.pnpm/@types+react@19.2.14/node_modules/@types/react/jsx-runtime\").JSX.Element", "jsxTree": {"tag": "<>", "children": [{"tag": "div", "children": [{"tag": "span", "children": [], "isMap": false, "isConditional": false}, {"tag": "span", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, {"tag": "button", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, "hookCalls": [], "imports": [], "storeAccess": []}, {"id": "apps/lore-weave/webui/src/components/runner/index.js::ConfigViewer", "name": "ConfigViewer", "kind": "component", "filePath": "apps/lore-weave/webui/src/components/runner/index.js", "sourceCode": "export default function ConfigViewer({ engineConfig, debugConfig, onShowDebugModal }) {\n  const [showConfig, setShowConfig] = useState(false);\n\n  const copyConfig = useCallback(() => {\n    navigator.clipboard.writeText(JSON.stringify(engineConfig, null, 2));\n  }, [engineConfig]);\n\n  return (\n    <>\n      <div className=\"cv-row\">\n        <div\n          className=\"lw-config-toggle cv-toggle-flush\"\n          onClick={() => setShowConfig(!showConfig)}\n          role=\"button\"\n          tabIndex={0}\n          onKeyDown={(e) => { if (e.key === \"Enter\" || e.key === \" \") e.currentTarget.click(); }}\n        >\n          <span>{showConfig ? \"\u25bc\" : \"\u25b6\"}</span>\n          <span>View Engine Configuration</span>\n          <button\n            className=\"lw-btn-copy\"\n            onClick={(e) => {\n              e.stopPropagation();\n              copyConfig();\n            }}\n          >\n            Copy\n          </button>\n        </div>\n        <button\n          className={`lw-btn lw-btn-debug ${debugConfig.enabled ? \"active\" : \"\"}`}\n          onClick={onShowDebugModal}\n        >\n          \ud83d\udd27 Debug {debugConfig.enabled ? `(${debugConfig.enabledCategories.length || \"All\"})` : \"\"}\n        </button>\n      </div>\n      {showConfig && (\n        <div className=\"lw-config-output\">{JSON.stringify(engineConfig, null, 2)}</div>\n      )}\n    </>\n  );\n}", "parameters": [{"name": "{ engineConfig, debugConfig, onShowDebugModal }", "type": "{ engineConfig: any; debugConfig: any; onShowDebugModal: any; }", "optional": false}], "returnType": "import(\"/home/tsonu/src/the-canonry/node_modules/.pnpm/@types+react@19.2.14/node_modules/@types/react/jsx-runtime\").JSX.Element", "jsxTree": {"tag": "<>", "children": [{"tag": "div", "children": [{"tag": "div", "children": [{"tag": "span", "children": [], "isMap": false, "isConditional": false}, {"tag": "span", "children": [], "isMap": false, "isConditional": false}, {"tag": "button", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, {"tag": "button", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, {"tag": "div", "children": [], "isMap": false, "isConditional": true}], "isMap": false, "isConditional": false}, "hookCalls": [{"name": "useState", "count": 1}, {"name": "useCallback", "count": 1}], "imports": [], "storeAccess": []}, {"id": "apps/lore-weave/webui/src/components/targets/index.js::DistributionTargetsEditor", "name": "DistributionTargetsEditor", "kind": "component", "filePath": "apps/lore-weave/webui/src/components/targets/index.js", "sourceCode": "export default function DistributionTargetsEditor({\n  distributionTargets,\n  schema,\n  onDistributionTargetsChange,\n}) {\n  // Create default targets if none exist\n  const createDefaultTargets = useCallback(() => {\n    const defaultTargets = {\n      $schema: \"Per-subtype targets for homeostatic template weighting\",\n      version: \"1.0.0\",\n      entities: {},\n    };\n\n    // Populate per-subtype targets from schema (default 0)\n    if (schema?.entityKinds) {\n      schema.entityKinds.forEach((ek) => {\n        if (!defaultTargets.entities[ek.kind]) {\n          defaultTargets.entities[ek.kind] = {};\n        }\n        ek.subtypes?.forEach((subtype) => {\n          defaultTargets.entities[ek.kind][subtype.id] = { target: 0 };\n        });\n      });\n    }\n\n    onDistributionTargetsChange(defaultTargets);\n  }, [schema, onDistributionTargetsChange]);\n\n  // Update a nested path in the targets\n  const updateTargets = useCallback(\n    (path, value) => {\n      if (!distributionTargets) return;\n\n      const newTargets = JSON.parse(JSON.stringify(distributionTargets));\n      const parts = path.split(\".\");\n      let current = newTargets;\n\n      for (let i = 0; i < parts.length - 1; i++) {\n        if (!current[parts[i]]) {\n          current[parts[i]] = {};\n        }\n        current = current[parts[i]];\n      }\n\n      current[parts[parts.length - 1]] = value;\n      onDistributionTargetsChange(newTargets);\n    },\n    [distributionTargets, onDistributionTargetsChange]\n  );\n\n  // If no targets exist, show empty state\n  if (\n    !distributionTargets ||\n    !distributionTargets.entities ||\n    Array.isArray(distributionTargets.entities)\n  ) {\n    return (\n      <div className=\"lw-container\">\n        <div className=\"lw-header\">\n          <h1 className=\"lw-title\">Distribution Targets</h1>\n          <p className=\"lw-subtitle\">\n            Configure per-subtype targets for homeostatic template weighting\n          </p>\n        </div>\n        <div className=\"lw-empty-state dte-empty-state\">\n          <div className=\"lw-empty-title\">No Distribution Targets Configured</div>\n          <div className=\"lw-empty-text\">\n            Set per-subtype targets used for homeostatic template weighting.\n          </div>\n          <button className=\"lw-btn lw-btn-primary\" onClick={createDefaultTargets}>\n            Create Default Targets\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"lw-container\">\n      <div className=\"lw-header\">\n        <h1 className=\"lw-title\">Distribution Targets</h1>\n        <p className=\"lw-subtitle\">\n          Configure per-subtype targets for homeostatic template weighting\n        </p>\n      </div>\n\n      {/* Content */}\n      <div className=\"lw-section\">\n        <EntityTargets\n          entities={distributionTargets.entities}\n          updateTargets={updateTargets}\n          distributionTargets={distributionTargets}\n        />\n      </div>\n    </div>\n  );\n}", "parameters": [{"name": "{\n  distributionTargets,\n  schema,\n  onDistributionTargetsChange,\n}", "type": "{ distributionTargets: any; schema: any; onDistributionTargetsChange: any; }", "optional": false}], "returnType": "import(\"/home/tsonu/src/the-canonry/node_modules/.pnpm/@types+react@19.2.14/node_modules/@types/react/jsx-runtime\").JSX.Element", "jsxTree": {"tag": "div", "children": [{"tag": "div", "children": [{"tag": "h1", "children": [], "isMap": false, "isConditional": false}, {"tag": "p", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, {"tag": "div", "children": [{"tag": "div", "children": [], "isMap": false, "isConditional": false}, {"tag": "div", "children": [], "isMap": false, "isConditional": false}, {"tag": "button", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, "hookCalls": [{"name": "useCallback", "count": 2}], "imports": [], "storeAccess": []}, {"id": "apps/lore-weave/webui/src/components/targets/index.js::EntityTargets", "name": "EntityTargets", "kind": "component", "filePath": "apps/lore-weave/webui/src/components/targets/index.js", "sourceCode": "export default function EntityTargets({ entities, updateTargets, distributionTargets }) {\n  // Group by entity kind\n  const kindGroups = {};\n  Object.entries(entities).forEach(([key, value]) => {\n    if (key === \"comment\") return;\n    if (typeof value === \"object\") {\n      kindGroups[key] = value;\n    }\n  });\n\n  return (\n    <>\n      <p className=\"lw-section-description\">\n        Per-subtype population targets for homeostatic control\n      </p>\n      {Object.entries(kindGroups).map(([kind, subtypes]) => (\n        <div key={kind} className=\"lw-card\">\n          <div className=\"lw-card-title\">{kind}</div>\n          {Object.entries(subtypes).map(([subtype, config]) => (\n            <div key={subtype} className=\"lw-row\">\n              <span className=\"lw-row-label\">{subtype}</span>\n              <div className=\"et-controls\">\n                <label className=\"lw-label et-label-inline\">\n                  Target:\n                <NumberInput\n                  className=\"lw-input-small\"\n                  value={config.target || 0}\n                  onChange={(v) => {\n                    const currentEntities = distributionTargets.entities;\n                    const newEntities = JSON.parse(JSON.stringify(currentEntities));\n                    if (!newEntities[kind]) newEntities[kind] = {};\n                    newEntities[kind][subtype] = { ...config, target: v ?? 0 };\n                    updateTargets(\"entities\", newEntities);\n                  }}\n                  integer\n                />\n                </label>\n              </div>\n              {config.comment && (\n                <span className=\"lw-comment et-comment\">\n                  {config.comment}\n                </span>\n              )}\n            </div>\n          ))}\n        </div>\n      ))}\n    </>\n  );\n}", "parameters": [{"name": "{ entities, updateTargets, distributionTargets }", "type": "{ entities: any; updateTargets: any; distributionTargets: any; }", "optional": false}], "returnType": "import(\"/home/tsonu/src/the-canonry/node_modules/.pnpm/@types+react@19.2.14/node_modules/@types/react/jsx-runtime\").JSX.Element", "jsxTree": {"tag": "<>", "children": [{"tag": "p", "children": [], "isMap": false, "isConditional": false}, {"tag": "div", "children": [{"tag": "div", "children": [], "isMap": false, "isConditional": false}, {"tag": "div", "children": [{"tag": "span", "children": [], "isMap": false, "isConditional": false}, {"tag": "div", "children": [{"tag": "label", "children": [{"tag": "NumberInput", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, {"tag": "span", "children": [], "isMap": false, "isConditional": true}], "isMap": true, "isConditional": false}], "isMap": true, "isConditional": false}], "isMap": false, "isConditional": false}, "hookCalls": [], "imports": [], "storeAccess": []}, {"id": "apps/lore-weave/webui/src/components/dashboard/systems/GraphContagionVis.jsx::GraphContagionVis", "name": "GraphContagionVis", "kind": "component", "filePath": "apps/lore-weave/webui/src/components/dashboard/systems/GraphContagionVis.jsx", "sourceCode": "/**\n * Main exported component\n */\nexport function GraphContagionVis({ config, systemActions, selectedTick }) {\n  // Find all snapshots from systemActions\n  const snapshots = useMemo(() => {\n    if (!systemActions?.length) return [];\n    return systemActions\n      .filter((a) => a.details?.contagionSnapshot)\n      .map((a) => ({\n        tick: a.tick,\n        snapshot: a.details.contagionSnapshot,\n      }))\n      .sort((a, b) => a.tick - b.tick);\n  }, [systemActions]);\n\n  // Find snapshot for current tick\n  const currentSnapshot = useMemo(() => {\n    if (!snapshots.length) return null;\n\n    // If no tick selected, return most recent snapshot\n    if (selectedTick === undefined || selectedTick === null) {\n      return snapshots[snapshots.length - 1].snapshot;\n    }\n\n    // Find snapshot at or before selected tick\n    // If no snapshot exists yet at that tick, return null (don't show future data)\n    const atOrBefore = snapshots.filter((s) => s.tick <= selectedTick);\n    if (atOrBefore.length > 0) {\n      return atOrBefore[atOrBefore.length - 1].snapshot;\n    }\n    return null;\n  }, [snapshots, selectedTick]);\n\n  // Generate network from snapshot\n  const network = useMemo(() => {\n    if (!currentSnapshot) return { nodes: [], links: [] };\n    return generateNetworkFromSnapshot(currentSnapshot);\n  }, [currentSnapshot]);\n\n  if (!config) {\n    return (\n      <div className=\"vis-empty\">\n        <div className=\"vis-empty-icon\">&#9673;</div>\n        <div>No contagion configuration</div>\n      </div>\n    );\n  }\n\n  if (!currentSnapshot) {\n    return (\n      <div className=\"vis-empty\">\n        <div className=\"vis-empty-icon\">&#9673;</div>\n        <div>No contagion data</div>\n        <div className=\"vis-info-hint\">\n          Run simulation with {config.name} enabled\n        </div>\n      </div>\n    );\n  }\n\n  // Get state counts from snapshot\n  const counts = currentSnapshot.counts || {};\n  const newInfections = currentSnapshot.newInfections?.length || 0;\n\n  return (\n    <div className=\"vis-container\">\n      <div className=\"vis-container-header\">\n        <div className=\"vis-container-title\">\n          {config.name}\n          <span className=\"vis-subtitle\">\n            S:{counts.susceptible || 0} I:{counts.infected || 0} R:{counts.recovered || 0}\n          </span>\n        </div>\n        {newInfections > 0 && (\n          <div className=\"vis-info-danger\">+{newInfections} new infections</div>\n        )}\n      </div>\n      <div className=\"vis-container-body vis-container-body-full\">\n        <ParentSize>\n          {({ width, height }) =>\n            width > 0 &&\n            height > 0 && (\n              <ContagionGraph\n                width={width}\n                height={height}\n                network={network}\n                config={config}\n                selectedTick={selectedTick}\n                isPlaying={false}\n              />\n            )\n          }\n        </ParentSize>\n        <StateLegend />\n      </div>\n    </div>\n  );\n}", "parameters": [{"name": "{ config, systemActions, selectedTick }", "type": "{ config: any; systemActions: any; selectedTick: any; }", "optional": false}], "returnType": "import(\"/home/tsonu/src/the-canonry/node_modules/.pnpm/@types+react@19.2.14/node_modules/@types/react/jsx-runtime\").JSX.Element", "jsxTree": {"tag": "div", "children": [{"tag": "div", "children": [], "isMap": false, "isConditional": false}, {"tag": "div", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, "hookCalls": [{"name": "useMemo", "count": 3}], "imports": [{"source": "react", "specifiers": ["React", "useMemo", "useState", "useCallback", "useRef", "useEffect"], "category": "framework"}, {"source": "prop-types", "specifiers": ["PropTypes"], "category": "external"}, {"source": "@visx/group", "specifiers": ["Group"], "category": "external"}, {"source": "@visx/responsive", "specifiers": ["ParentSize"], "category": "external"}, {"source": "d3-force", "specifiers": ["* as d3Force"], "category": "external"}, {"source": "./visualizations.css", "specifiers": [], "category": "internal"}], "storeAccess": []}, {"id": "apps/lore-weave/webui/src/components/dashboard/systems/index.js::PlaneDiffusionVis", "name": "PlaneDiffusionVis", "kind": "component", "filePath": "apps/lore-weave/webui/src/components/dashboard/systems/index.js", "sourceCode": "/**\n * Main exported component with responsive wrapper\n *\n * @param {boolean} autoScaleColors - If true, scale colors to actual min/max instead of fixed -100/100\n */\nexport function PlaneDiffusionVis({\n  config,\n  systemActions,\n  selectedTick,\n  autoScaleColors = false,\n}) {\n  // Find the snapshot for the selected tick (or most recent if no tick selected)\n  const snapshot = useMemo(() => {\n    if (!systemActions?.length) return null;\n\n    // Filter to actions from this system that have diffusion snapshots\n    const validActions = systemActions.filter((a) => a.details?.diffusionSnapshot);\n    if (!validActions.length) return null;\n\n    // If selectedTick is specified, find closest action at or before that tick\n    // If no snapshot exists yet at that tick, return null (don't show future data)\n    if (selectedTick !== undefined && selectedTick !== null) {\n      const atOrBefore = validActions.filter((a) => a.tick <= selectedTick);\n      if (atOrBefore.length > 0) {\n        return atOrBefore[atOrBefore.length - 1].details.diffusionSnapshot;\n      }\n      // No snapshot at or before selected tick - return null\n      return null;\n    }\n\n    // No tick selected - return most recent snapshot\n    return validActions[validActions.length - 1].details.diffusionSnapshot;\n  }, [systemActions, selectedTick]);\n\n  // Extract data from snapshot\n  const {\n    gridData,\n    gridSize,\n    valueRange,\n    gridStats,\n    sources,\n    sinks,\n    entities: entityData,\n  } = useMemo(() => {\n    if (!snapshot) {\n      return {\n        gridData: null,\n        gridSize: 100,\n        valueRange: { min: -100, max: 100 },\n        gridStats: null,\n        sources: [],\n        sinks: [],\n        entities: [],\n      };\n    }\n\n    // Use fixed coordinate system (0-100 is the semantic plane range)\n    const PLANE_RANGE = 100;\n\n    const normalize = (p) => ({\n      ...p,\n      x: p.x / PLANE_RANGE,\n      y: p.y / PLANE_RANGE,\n    });\n\n    // Determine color scale range\n    let effectiveRange = snapshot.valueRange || { min: -100, max: 100 };\n    if (autoScaleColors && snapshot.gridStats) {\n      // Use actual data range for better visibility of small values\n      const { min, max } = snapshot.gridStats;\n      // Add small padding and ensure we don't have a zero-width range\n      const padding = Math.max(1, (max - min) * 0.05);\n      effectiveRange = {\n        min: min - padding,\n        max: max + padding,\n      };\n    }\n\n    return {\n      gridData: snapshot.grid,\n      gridSize: snapshot.gridSize || 100,\n      valueRange: effectiveRange,\n      gridStats: snapshot.gridStats || null,\n      sources: snapshot.sources.map((s) => ({\n        ...normalize(s),\n        label: s.name?.slice(0, 8) || \"S\",\n      })),\n      sinks: (snapshot.sinks || []).map((k) => ({\n        ...normalize(k),\n        label: k.name?.slice(0, 8) || \"K\",\n      })),\n      entities: snapshot.entities.map((e) => ({\n        ...normalize(e),\n        fieldValue: e.fieldValue,\n      })),\n    };\n  }, [snapshot, autoScaleColors]);\n\n  if (!config) {\n    return (\n      <div className=\"vis-empty\">\n        <div className=\"vis-empty-icon\">&#9783;</div>\n        <div>No diffusion configuration</div>\n      </div>\n    );\n  }\n\n  if (!snapshot) {\n    return (\n      <div className=\"vis-empty\">\n        <div className=\"vis-empty-icon\">&#9783;</div>\n        <div>No diffusion data</div>\n        <div className=\"vis-info-hint\">\n          Run simulation with {config.name} enabled\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"vis-container\">\n      <div className=\"vis-container-header\">\n        <div className=\"vis-container-title\">\n          {config.name}\n          {selectedTick !== undefined && (\n            <span className=\"vis-subtitle\">Tick {selectedTick}</span>\n          )}\n        </div>\n        <div className=\"vis-info-text\">\n          {sources.length} sources, {sinks.length} sinks, {entityData.length} entities\n          {gridStats && (\n            <span className=\"vis-info-stats\">\n              | min: {gridStats.min?.toFixed(1)} max: {gridStats.max?.toFixed(1)} avg:{\" \"}\n              {gridStats.avg?.toFixed(2)} ({gridStats.nonZeroCount} non-zero)\n            </span>\n          )}\n        </div>\n      </div>\n      <div className=\"vis-container-body\">\n        <ParentSize>\n          {({ width, height }) =>\n            width > 0 &&\n            height > 0 && (\n              <DiffusionFieldChart\n                width={width}\n                height={height}\n                gridData={gridData}\n                gridSize={gridSize}\n                valueRange={valueRange}\n                sources={sources}\n                sinks={sinks}\n                entities={entityData}\n                useLogScale={autoScaleColors}\n              />\n            )\n          }\n        </ParentSize>\n        <GradientLegend\n          title={autoScaleColors ? \"Field Value (log scale)\" : \"Field Value\"}\n          minLabel=\"-100\"\n          centerLabel=\"0\"\n          maxLabel=\"+100\"\n        />\n      </div>\n    </div>\n  );\n}", "parameters": [{"name": "{\n  config,\n  systemActions,\n  selectedTick,\n  autoScaleColors = false,\n}", "type": "boolean", "optional": false}], "returnType": "import(\"/home/tsonu/src/the-canonry/node_modules/.pnpm/@types+react@19.2.14/node_modules/@types/react/jsx-runtime\").JSX.Element", "jsxTree": {"tag": "div", "children": [{"tag": "div", "children": [], "isMap": false, "isConditional": false}, {"tag": "div", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, "hookCalls": [{"name": "useMemo", "count": 2}], "imports": [], "storeAccess": []}, {"id": "apps/lore-weave/webui/src/components/dashboard/systems/index.js::GraphContagionVis", "name": "GraphContagionVis", "kind": "component", "filePath": "apps/lore-weave/webui/src/components/dashboard/systems/index.js", "sourceCode": "/**\n * Main exported component\n */\nexport function GraphContagionVis({ config, systemActions, selectedTick }) {\n  // Find all snapshots from systemActions\n  const snapshots = useMemo(() => {\n    if (!systemActions?.length) return [];\n    return systemActions\n      .filter((a) => a.details?.contagionSnapshot)\n      .map((a) => ({\n        tick: a.tick,\n        snapshot: a.details.contagionSnapshot,\n      }))\n      .sort((a, b) => a.tick - b.tick);\n  }, [systemActions]);\n\n  // Find snapshot for current tick\n  const currentSnapshot = useMemo(() => {\n    if (!snapshots.length) return null;\n\n    // If no tick selected, return most recent snapshot\n    if (selectedTick === undefined || selectedTick === null) {\n      return snapshots[snapshots.length - 1].snapshot;\n    }\n\n    // Find snapshot at or before selected tick\n    // If no snapshot exists yet at that tick, return null (don't show future data)\n    const atOrBefore = snapshots.filter((s) => s.tick <= selectedTick);\n    if (atOrBefore.length > 0) {\n      return atOrBefore[atOrBefore.length - 1].snapshot;\n    }\n    return null;\n  }, [snapshots, selectedTick]);\n\n  // Generate network from snapshot\n  const network = useMemo(() => {\n    if (!currentSnapshot) return { nodes: [], links: [] };\n    return generateNetworkFromSnapshot(currentSnapshot);\n  }, [currentSnapshot]);\n\n  if (!config) {\n    return (\n      <div className=\"vis-empty\">\n        <div className=\"vis-empty-icon\">&#9673;</div>\n        <div>No contagion configuration</div>\n      </div>\n    );\n  }\n\n  if (!currentSnapshot) {\n    return (\n      <div className=\"vis-empty\">\n        <div className=\"vis-empty-icon\">&#9673;</div>\n        <div>No contagion data</div>\n        <div className=\"vis-info-hint\">\n          Run simulation with {config.name} enabled\n        </div>\n      </div>\n    );\n  }\n\n  // Get state counts from snapshot\n  const counts = currentSnapshot.counts || {};\n  const newInfections = currentSnapshot.newInfections?.length || 0;\n\n  return (\n    <div className=\"vis-container\">\n      <div className=\"vis-container-header\">\n        <div className=\"vis-container-title\">\n          {config.name}\n          <span className=\"vis-subtitle\">\n            S:{counts.susceptible || 0} I:{counts.infected || 0} R:{counts.recovered || 0}\n          </span>\n        </div>\n        {newInfections > 0 && (\n          <div className=\"vis-info-danger\">+{newInfections} new infections</div>\n        )}\n      </div>\n      <div className=\"vis-container-body vis-container-body-full\">\n        <ParentSize>\n          {({ width, height }) =>\n            width > 0 &&\n            height > 0 && (\n              <ContagionGraph\n                width={width}\n                height={height}\n                network={network}\n                config={config}\n                selectedTick={selectedTick}\n                isPlaying={false}\n              />\n            )\n          }\n        </ParentSize>\n        <StateLegend />\n      </div>\n    </div>\n  );\n}", "parameters": [{"name": "{ config, systemActions, selectedTick }", "type": "{ config: any; systemActions: any; selectedTick: any; }", "optional": false}], "returnType": "import(\"/home/tsonu/src/the-canonry/node_modules/.pnpm/@types+react@19.2.14/node_modules/@types/react/jsx-runtime\").JSX.Element", "jsxTree": {"tag": "div", "children": [{"tag": "div", "children": [], "isMap": false, "isConditional": false}, {"tag": "div", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, "hookCalls": [{"name": "useMemo", "count": 3}], "imports": [], "storeAccess": []}, {"id": "apps/lore-weave/webui/src/components/dashboard/systems/index.js::SystemActivityPanel", "name": "SystemActivityPanel", "kind": "component", "filePath": "apps/lore-weave/webui/src/components/dashboard/systems/index.js", "sourceCode": "/**\n * Main panel component\n */\nexport default function SystemActivityPanel({ systemActions }) {\n  const [activeView, setActiveView] = useState(\"swimlane\");\n\n  const { systems, timeline, maxTick } = useMemo(\n    () => processSystemActions(systemActions),\n    [systemActions]\n  );\n\n  if (!systems.length) {\n    return (\n      <div className=\"system-activity-empty\">\n        <div className=\"system-activity-empty-icon\">&#9881;</div>\n        <div>No system activity recorded</div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"system-activity-panel\">\n      {/* Header with view toggle */}\n      <div className=\"system-activity-header\">\n        <div className=\"system-activity-title\">System Activity</div>\n        <div className=\"system-activity-toggles\">\n          <button\n            className={`system-toggle ${activeView === \"swimlane\" ? \"active\" : \"\"}`}\n            onClick={() => setActiveView(\"swimlane\")}\n          >\n            Swimlane\n          </button>\n          <button\n            className={`system-toggle ${activeView === \"timeline\" ? \"active\" : \"\"}`}\n            onClick={() => setActiveView(\"timeline\")}\n          >\n            Timeline\n          </button>\n        </div>\n      </div>\n\n      {/* Summary cards */}\n      <SystemSummaryCards systems={systems} />\n\n      {/* Chart area */}\n      <div className=\"system-activity-chart\">\n        <ParentSize>\n          {({ width, height: _height }) => {\n            if (width === 0) return null;\n            const chartHeight = Math.max(200, Math.min(300, systems.length * 40 + 60));\n\n            return activeView === \"swimlane\" ? (\n              <SystemSwimlaneChart\n                systems={systems}\n                maxTick={maxTick}\n                width={width}\n                height={chartHeight}\n              />\n            ) : (\n              <ActivityTimelineChart\n                timeline={timeline}\n                maxTick={maxTick}\n                width={width}\n                height={chartHeight}\n              />\n            );\n          }}\n        </ParentSize>\n      </div>\n\n      {/* Legend */}\n      <div className=\"system-activity-legend\">\n        {activeView === \"timeline\" && (\n          <>\n            <div className=\"legend-item\">\n              <span className=\"legend-line sa-legend-line\" style={{ '--sa-legend-line-color': '#8b5cf6' }} />\n              <span>Relationships Added</span>\n            </div>\n            <div className=\"legend-item\">\n              <span className=\"legend-line dashed sa-legend-line\" style={{ '--sa-legend-line-color': '#22c55e' }} />\n              <span>Entities Modified</span>\n            </div>\n          </>\n        )}\n        {activeView === \"swimlane\" && (\n          <>\n            <div className=\"legend-item\">\n              <Circle cx={6} cy={6} r={6} fill=\"#8b5cf6\" />\n              <span>Active (with changes)</span>\n            </div>\n            <div className=\"legend-item\">\n              <Circle cx={6} cy={6} r={3} fill=\"#64748b\" fillOpacity={0.3} />\n              <span>Dormant</span>\n            </div>\n          </>\n        )}\n      </div>\n    </div>\n  );\n}", "parameters": [{"name": "{ systemActions }", "type": "{ systemActions: any; }", "optional": false}], "returnType": "import(\"/home/tsonu/src/the-canonry/node_modules/.pnpm/@types+react@19.2.14/node_modules/@types/react/jsx-runtime\").JSX.Element", "jsxTree": {"tag": "div", "children": [{"tag": "div", "children": [], "isMap": false, "isConditional": false}, {"tag": "div", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, "hookCalls": [{"name": "useState", "count": 1}, {"name": "useMemo", "count": 1}], "imports": [], "storeAccess": []}, {"id": "apps/lore-weave/webui/src/components/dashboard/systems/PlaneDiffusionVis.jsx::PlaneDiffusionVis", "name": "PlaneDiffusionVis", "kind": "component", "filePath": "apps/lore-weave/webui/src/components/dashboard/systems/PlaneDiffusionVis.jsx", "sourceCode": "/**\n * Main exported component with responsive wrapper\n *\n * @param {boolean} autoScaleColors - If true, scale colors to actual min/max instead of fixed -100/100\n */\nexport function PlaneDiffusionVis({\n  config,\n  systemActions,\n  selectedTick,\n  autoScaleColors = false,\n}) {\n  // Find the snapshot for the selected tick (or most recent if no tick selected)\n  const snapshot = useMemo(() => {\n    if (!systemActions?.length) return null;\n\n    // Filter to actions from this system that have diffusion snapshots\n    const validActions = systemActions.filter((a) => a.details?.diffusionSnapshot);\n    if (!validActions.length) return null;\n\n    // If selectedTick is specified, find closest action at or before that tick\n    // If no snapshot exists yet at that tick, return null (don't show future data)\n    if (selectedTick !== undefined && selectedTick !== null) {\n      const atOrBefore = validActions.filter((a) => a.tick <= selectedTick);\n      if (atOrBefore.length > 0) {\n        return atOrBefore[atOrBefore.length - 1].details.diffusionSnapshot;\n      }\n      // No snapshot at or before selected tick - return null\n      return null;\n    }\n\n    // No tick selected - return most recent snapshot\n    return validActions[validActions.length - 1].details.diffusionSnapshot;\n  }, [systemActions, selectedTick]);\n\n  // Extract data from snapshot\n  const {\n    gridData,\n    gridSize,\n    valueRange,\n    gridStats,\n    sources,\n    sinks,\n    entities: entityData,\n  } = useMemo(() => {\n    if (!snapshot) {\n      return {\n        gridData: null,\n        gridSize: 100,\n        valueRange: { min: -100, max: 100 },\n        gridStats: null,\n        sources: [],\n        sinks: [],\n        entities: [],\n      };\n    }\n\n    // Use fixed coordinate system (0-100 is the semantic plane range)\n    const PLANE_RANGE = 100;\n\n    const normalize = (p) => ({\n      ...p,\n      x: p.x / PLANE_RANGE,\n      y: p.y / PLANE_RANGE,\n    });\n\n    // Determine color scale range\n    let effectiveRange = snapshot.valueRange || { min: -100, max: 100 };\n    if (autoScaleColors && snapshot.gridStats) {\n      // Use actual data range for better visibility of small values\n      const { min, max } = snapshot.gridStats;\n      // Add small padding and ensure we don't have a zero-width range\n      const padding = Math.max(1, (max - min) * 0.05);\n      effectiveRange = {\n        min: min - padding,\n        max: max + padding,\n      };\n    }\n\n    return {\n      gridData: snapshot.grid,\n      gridSize: snapshot.gridSize || 100,\n      valueRange: effectiveRange,\n      gridStats: snapshot.gridStats || null,\n      sources: snapshot.sources.map((s) => ({\n        ...normalize(s),\n        label: s.name?.slice(0, 8) || \"S\",\n      })),\n      sinks: (snapshot.sinks || []).map((k) => ({\n        ...normalize(k),\n        label: k.name?.slice(0, 8) || \"K\",\n      })),\n      entities: snapshot.entities.map((e) => ({\n        ...normalize(e),\n        fieldValue: e.fieldValue,\n      })),\n    };\n  }, [snapshot, autoScaleColors]);\n\n  if (!config) {\n    return (\n      <div className=\"vis-empty\">\n        <div className=\"vis-empty-icon\">&#9783;</div>\n        <div>No diffusion configuration</div>\n      </div>\n    );\n  }\n\n  if (!snapshot) {\n    return (\n      <div className=\"vis-empty\">\n        <div className=\"vis-empty-icon\">&#9783;</div>\n        <div>No diffusion data</div>\n        <div className=\"vis-info-hint\">\n          Run simulation with {config.name} enabled\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"vis-container\">\n      <div className=\"vis-container-header\">\n        <div className=\"vis-container-title\">\n          {config.name}\n          {selectedTick !== undefined && (\n            <span className=\"vis-subtitle\">Tick {selectedTick}</span>\n          )}\n        </div>\n        <div className=\"vis-info-text\">\n          {sources.length} sources, {sinks.length} sinks, {entityData.length} entities\n          {gridStats && (\n            <span className=\"vis-info-stats\">\n              | min: {gridStats.min?.toFixed(1)} max: {gridStats.max?.toFixed(1)} avg:{\" \"}\n              {gridStats.avg?.toFixed(2)} ({gridStats.nonZeroCount} non-zero)\n            </span>\n          )}\n        </div>\n      </div>\n      <div className=\"vis-container-body\">\n        <ParentSize>\n          {({ width, height }) =>\n            width > 0 &&\n            height > 0 && (\n              <DiffusionFieldChart\n                width={width}\n                height={height}\n                gridData={gridData}\n                gridSize={gridSize}\n                valueRange={valueRange}\n                sources={sources}\n                sinks={sinks}\n                entities={entityData}\n                useLogScale={autoScaleColors}\n              />\n            )\n          }\n        </ParentSize>\n        <GradientLegend\n          title={autoScaleColors ? \"Field Value (log scale)\" : \"Field Value\"}\n          minLabel=\"-100\"\n          centerLabel=\"0\"\n          maxLabel=\"+100\"\n        />\n      </div>\n    </div>\n  );\n}", "parameters": [{"name": "{\n  config,\n  systemActions,\n  selectedTick,\n  autoScaleColors = false,\n}", "type": "boolean", "optional": false}], "returnType": "import(\"/home/tsonu/src/the-canonry/node_modules/.pnpm/@types+react@19.2.14/node_modules/@types/react/jsx-runtime\").JSX.Element", "jsxTree": {"tag": "div", "children": [{"tag": "div", "children": [], "isMap": false, "isConditional": false}, {"tag": "div", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, "hookCalls": [{"name": "useMemo", "count": 2}], "imports": [{"source": "react", "specifiers": ["React", "useMemo", "useState", "useCallback", "useRef"], "category": "framework"}, {"source": "prop-types", "specifiers": ["PropTypes"], "category": "external"}, {"source": "@visx/group", "specifiers": ["Group"], "category": "external"}, {"source": "@visx/scale", "specifiers": ["scaleLinear"], "category": "external"}, {"source": "@visx/responsive", "specifiers": ["ParentSize"], "category": "external"}, {"source": "./visualizations.css", "specifiers": [], "category": "internal"}], "storeAccess": []}, {"id": "apps/lore-weave/webui/src/components/dashboard/trace/index.js::SimulationTraceVisx", "name": "SimulationTraceVisx", "kind": "component", "filePath": "apps/lore-weave/webui/src/components/dashboard/trace/index.js", "sourceCode": "/**\n * Main component with responsive wrapper\n */\nexport default function SimulationTraceVisx({\n  pressureUpdates = [],\n  epochStats = [],\n  templateApplications = [],\n  actionApplications = [],\n  systemActions = [],\n  onClose,\n}) {\n  // State\n  const [selectedTick, setSelectedTick] = useState(null);\n  const [lockedTick, setLockedTick] = useState(null);\n  const [hiddenPressures, setHiddenPressures] = useState(new Set());\n  const [hoveredEventId, setHoveredEventId] = useState(null);\n  const [selectedEventId, setSelectedEventId] = useState(null);\n  const [scrollOffset, setScrollOffset] = useState(null);\n  const [systemPanel, setSystemPanel] = useState(null); // null | 'activity' | 'plane-diffusion' | 'graph-contagion'\n  const [selectedDiffusionId, setSelectedDiffusionId] = useState(null);\n  const [selectedContagionId, setSelectedContagionId] = useState(null);\n  const [autoScaleColors, setAutoScaleColors] = useState(false);\n\n  // Derive available diffusion/contagion systems from what actually ran (has snapshot data in systemActions)\n  const diffusionSystemsWithData = useMemo(() => {\n    const systemsMap = new Map();\n    for (const action of systemActions) {\n      if (action.details?.diffusionSnapshot && !systemsMap.has(action.systemId)) {\n        systemsMap.set(action.systemId, {\n          id: action.systemId,\n          name: action.systemName,\n        });\n      }\n    }\n    return Array.from(systemsMap.values());\n  }, [systemActions]);\n\n  const contagionSystemsWithData = useMemo(() => {\n    const systemsMap = new Map();\n    for (const action of systemActions) {\n      if (action.details?.contagionSnapshot && !systemsMap.has(action.systemId)) {\n        systemsMap.set(action.systemId, {\n          id: action.systemId,\n          name: action.systemName,\n        });\n      }\n    }\n    return Array.from(systemsMap.values());\n  }, [systemActions]);\n\n  // Auto-select first available system if none selected\n  const activeDiffusionId = selectedDiffusionId ?? diffusionSystemsWithData[0]?.id ?? null;\n  const activeContagionId = selectedContagionId ?? contagionSystemsWithData[0]?.id ?? null;\n\n  const diffusionConfig = useMemo(\n    () => ({\n      name: diffusionSystemsWithData.find((s) => s.id === activeDiffusionId)?.name,\n    }),\n    [diffusionSystemsWithData, activeDiffusionId]\n  );\n\n  const contagionConfig = useMemo(\n    () => ({\n      name: contagionSystemsWithData.find((s) => s.id === activeContagionId)?.name,\n    }),\n    [contagionSystemsWithData, activeContagionId]\n  );\n\n  // Transform data\n  const {\n    data: pressureData,\n    pressureIds,\n    breakdownsByTick,\n  } = useMemo(() => transformPressureData(pressureUpdates), [pressureUpdates]);\n\n  const eventData = useMemo(\n    () => transformEventData(templateApplications, actionApplications, systemActions, pressureData),\n    [templateApplications, actionApplications, systemActions, pressureData]\n  );\n\n  const eraBoundaries = useMemo(\n    () => extractEraBoundaries(pressureUpdates, epochStats, systemActions),\n    [pressureUpdates, epochStats, systemActions]\n  );\n\n  // Get selected event for detail panel (template, action, or system action)\n  const selectedEvent = useMemo(() => {\n    const eventId = selectedEventId || hoveredEventId;\n    if (!eventId) return null;\n\n    // Check templates first\n    const templateEvent = eventData.template.find((e) => e.uniqueId === eventId);\n    if (templateEvent) {\n      return { type: \"template\", data: templateEvent.data };\n    }\n\n    // Check action applications\n    const actionEvent = eventData.action.find((e) => e.uniqueId === eventId);\n    if (actionEvent) {\n      return { type: \"action\", data: actionEvent.data };\n    }\n\n    // Check system actions\n    const systemEvent = eventData.system.find((e) => e.uniqueId === eventId);\n    if (systemEvent) {\n      return {\n        type: \"system\",\n        data: systemEvent.data,\n        isEraTransition: systemEvent.isEraTransition,\n      };\n    }\n\n    return null;\n  }, [eventData, selectedEventId, hoveredEventId]);\n\n  // Count era transitions for display\n  const eraTransitionCount = useMemo(\n    () => eventData.system.filter((e) => e.isEraTransition).length,\n    [eventData]\n  );\n\n  // Get max tick for slider (from pressure data or system actions)\n  const maxTick = useMemo(() => {\n    const pressureMax = pressureData.length > 0 ? Math.max(...pressureData.map((d) => d.tick)) : 0;\n    const systemMax = systemActions.length > 0 ? Math.max(...systemActions.map((a) => a.tick)) : 0;\n    return Math.max(pressureMax, systemMax, 1);\n  }, [pressureData, systemActions]);\n\n  // Get available ticks with visualization data for the active system\n  const availableVisTicks = useMemo(() => {\n    if (systemPanel === \"plane-diffusion\" && activeDiffusionId) {\n      return [\n        ...new Set(\n          systemActions\n            .filter((a) => a.systemId === activeDiffusionId && a.details?.diffusionSnapshot)\n            .map((a) => a.tick)\n        ),\n      ].sort((a, b) => a - b);\n    }\n    if (systemPanel === \"graph-contagion\" && activeContagionId) {\n      return [\n        ...new Set(\n          systemActions\n            .filter((a) => a.systemId === activeContagionId && a.details?.contagionSnapshot)\n            .map((a) => a.tick)\n        ),\n      ].sort((a, b) => a - b);\n    }\n    return [];\n  }, [systemPanel, activeDiffusionId, activeContagionId, systemActions]);\n\n  // Initialize lockedTick to maxTick when opening a visualization panel\n  // This ensures slider position matches displayed data\n  React.useEffect(() => {\n    if (\n      (systemPanel === \"plane-diffusion\" || systemPanel === \"graph-contagion\") &&\n      lockedTick === null\n    ) {\n      setLockedTick(maxTick);\n    }\n  }, [systemPanel, maxTick, lockedTick]);\n\n  // Handlers\n  const handleTickHover = useCallback((tick) => {\n    setSelectedTick(tick);\n  }, []);\n\n  const handleTickClick = useCallback(\n    (tick) => {\n      if (lockedTick === tick) {\n        setLockedTick(null);\n      } else {\n        setLockedTick(tick);\n        setSelectedTick(tick);\n      }\n    },\n    [lockedTick]\n  );\n\n  const handleEventHover = useCallback(\n    (eventId) => {\n      if (!selectedEventId) {\n        setHoveredEventId(eventId);\n      }\n    },\n    [selectedEventId]\n  );\n\n  const handleEventClick = useCallback(\n    (eventId) => {\n      if (selectedEventId === eventId) {\n        setSelectedEventId(null);\n      } else {\n        setSelectedEventId(eventId);\n      }\n    },\n    [selectedEventId]\n  );\n\n  const handleUnlock = useCallback(() => {\n    setLockedTick(null);\n  }, []);\n\n  const handleClearEvent = useCallback(() => {\n    setSelectedEventId(null);\n    setHoveredEventId(null);\n  }, []);\n\n  const togglePressure = useCallback((id) => {\n    setHiddenPressures((prev) => {\n      const next = new Set(prev);\n      if (next.has(id)) next.delete(id);\n      else next.add(id);\n      return next;\n    });\n  }, []);\n\n  return (\n    <div className=\"lw-trace-view-overlay\">\n      <div className=\"lw-trace-view\">\n        {/* Header */}\n        <div className=\"lw-trace-view-header\">\n          <div className=\"lw-trace-view-title\">\n            Simulation Trace\n            <span className=\"lw-trace-view-subtitle\">\n              {pressureData.length} ticks / {pressureIds.length} pressures /{\" \"}\n              {eventData.template.length} templates / {eventData.action.length} actions /{\" \"}\n              {eraTransitionCount} era transitions\n            </span>\n          </div>\n          <div className=\"lw-trace-view-header-actions\">\n            <button\n              className={`lw-trace-view-panel-toggle ${systemPanel === \"activity\" ? \"active\" : \"\"}`}\n              onClick={() => setSystemPanel(systemPanel === \"activity\" ? null : \"activity\")}\n            >\n              Activity\n            </button>\n            <button\n              className={`lw-trace-view-panel-toggle ${systemPanel === \"plane-diffusion\" ? \"active\" : \"\"} ${diffusionSystemsWithData.length > 0 ? \"has-data\" : \"\"}`}\n              onClick={() =>\n                setSystemPanel(systemPanel === \"plane-diffusion\" ? null : \"plane-diffusion\")\n              }\n              title={\n                diffusionSystemsWithData.length > 0\n                  ? `${diffusionSystemsWithData.length} system(s): ${diffusionSystemsWithData.map((s) => s.name).join(\", \")}`\n                  : \"No diffusion systems ran\"\n              }\n            >\n              Diffusion\n              {diffusionSystemsWithData.length > 0 && ` (${diffusionSystemsWithData.length})`}\n            </button>\n            <button\n              className={`lw-trace-view-panel-toggle ${systemPanel === \"graph-contagion\" ? \"active\" : \"\"} ${contagionSystemsWithData.length > 0 ? \"has-data\" : \"\"}`}\n              onClick={() =>\n                setSystemPanel(systemPanel === \"graph-contagion\" ? null : \"graph-contagion\")\n              }\n              title={\n                contagionSystemsWithData.length > 0\n                  ? `${contagionSystemsWithData.length} system(s): ${contagionSystemsWithData.map((s) => s.name).join(\", \")}`\n                  : \"No contagion systems ran\"\n              }\n            >\n              Contagion\n              {contagionSystemsWithData.length > 0 && ` (${contagionSystemsWithData.length})`}\n            </button>\n            <button className=\"lw-trace-view-close\" onClick={onClose}>\n              x\n            </button>\n          </div>\n        </div>\n\n        {/* Main content */}\n        <div className=\"lw-trace-view-content\">\n          {/* Left: Charts */}\n          <div className=\"lw-trace-view-charts\">\n            {/* Pressure toggles */}\n            <div className=\"lw-trace-view-toggles\">\n              {pressureIds.map((id, i) => {\n                const name = pressureData[0]?.[`${id}_name`] || id;\n                const isHidden = hiddenPressures.has(id);\n                return (\n                  <button\n                    key={id}\n                    className={`lw-trace-view-toggle ${isHidden ? \"hidden\" : \"\"}`}\n                    style={{\n                      '--st-toggle-border': PRESSURE_COLORS[i % PRESSURE_COLORS.length],\n                      '--st-toggle-bg': isHidden\n                        ? \"transparent\"\n                        : PRESSURE_COLORS[i % PRESSURE_COLORS.length] + \"20\",\n                    }}\n                    onClick={() => togglePressure(id)}\n                  >\n                    {name}\n                  </button>\n                );\n              })}\n            </div>\n\n            {/* Chart area */}\n            <div className={`lw-trace-view-chart-area ${lockedTick !== null ? \"locked\" : \"\"}`}>\n// ... (truncated)", "parameters": [{"name": "{\n  pressureUpdates = [],\n  epochStats = [],\n  templateApplications = [],\n  actionApplications = [],\n  systemActions = [],\n  onClose,\n}", "type": "{ pressureUpdates?: any[]; epochStats?: any[]; templateApplications?: any[]; actionApplications?: any[]; systemActions?: any[]; onClose: any; }", "optional": false}], "returnType": "import(\"/home/tsonu/src/the-canonry/node_modules/.pnpm/@types+react@19.2.14/node_modules/@types/react/jsx-runtime\").JSX.Element", "jsxTree": {"tag": "div", "children": [{"tag": "div", "children": [{"tag": "div", "children": [{"tag": "div", "children": [{"tag": "span", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, {"tag": "div", "children": [{"tag": "button", "children": [], "isMap": false, "isConditional": false}, {"tag": "button", "children": [], "isMap": false, "isConditional": false}, {"tag": "button", "children": [], "isMap": false, "isConditional": false}, {"tag": "button", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, {"tag": "div", "children": [{"tag": "div", "children": [{"tag": "div", "children": [{"tag": "button", "children": [], "isMap": true, "isConditional": false}], "isMap": false, "isConditional": false}, {"tag": "div", "children": [{"tag": "ParentSize", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, {"tag": "div", "children": [{"tag": "SystemActivityPanel", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": true}, {"tag": "div", "children": [{"tag": "div", "children": [{"tag": "div", "children": [], "isMap": false, "isConditional": false}, {"tag": "div", "children": [], "isMap": false, "isConditional": false}, {"tag": "div", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": true}, {"tag": "<>", "children": [{"tag": "div", "children": [{"tag": "select", "children": [{"tag": "option", "children": [], "isMap": true, "isConditional": false}], "isMap": false, "isConditional": true}, {"tag": "div", "children": [{"tag": "span", "children": [], "isMap": false, "isConditional": false}, {"tag": "input", "children": [], "isMap": false, "isConditional": false}, {"tag": "span", "children": [], "isMap": false, "isConditional": false}, {"tag": "span", "children": [], "isMap": false, "isConditional": true}], "isMap": false, "isConditional": false}, {"tag": "label", "children": [{"tag": "input", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, {"tag": "PlaneDiffusionVis", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": true}], "isMap": false, "isConditional": true}, {"tag": "div", "children": [{"tag": "div", "children": [{"tag": "div", "children": [], "isMap": false, "isConditional": false}, {"tag": "div", "children": [], "isMap": false, "isConditional": false}, {"tag": "div", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": true}, {"tag": "<>", "children": [{"tag": "div", "children": [{"tag": "select", "children": [{"tag": "option", "children": [], "isMap": true, "isConditional": false}], "isMap": false, "isConditional": true}, {"tag": "div", "children": [{"tag": "span", "children": [], "isMap": false, "isConditional": false}, {"tag": "input", "children": [], "isMap": false, "isConditional": false}, {"tag": "span", "children": [], "isMap": false, "isConditional": false}, {"tag": "span", "children": [], "isMap": false, "isConditional": true}], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, {"tag": "GraphContagionVis", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": true}], "isMap": false, "isConditional": true}], "isMap": false, "isConditional": false}, {"tag": "TemplateDetailPanel", "children": [], "isMap": false, "isConditional": true}, {"tag": "ActionDetailPanel", "children": [], "isMap": false, "isConditional": true}, {"tag": "SystemActionDetailPanel", "children": [], "isMap": false, "isConditional": true}, {"tag": "DetailPanel", "children": [], "isMap": false, "isConditional": true}], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, "hookCalls": [{"name": "useState", "count": 10}, {"name": "useMemo", "count": 11}, {"name": "useEffect", "count": 1}, {"name": "useCallback", "count": 7}], "imports": [], "storeAccess": []}, {"id": "apps/lore-weave/webui/src/components/dashboard/trace/index.js::PressureChart", "name": "PressureChart", "kind": "component", "filePath": "apps/lore-weave/webui/src/components/dashboard/trace/index.js", "sourceCode": "/**\n * Pressure chart component\n *\n * Note: `height` here is the y-coordinate of the chart bottom (chartBottom),\n * NOT the total chart height. The chart area spans from margin.top to height.\n */\nexport default function PressureChart({\n  data,\n  pressureIds,\n  hiddenPressures,\n  xScale,\n  yScale,\n  margin,\n  height, // This is chartBottom, not total height\n  width,\n}) {\n  if (!data?.length || !pressureIds?.length) {\n    return null;\n  }\n\n  const visiblePressures = pressureIds.filter((id) => !hiddenPressures.has(id));\n  // Chart area height is from margin.top to chartBottom (height param)\n  const chartAreaHeight = height - margin.top;\n  const zeroY = yScale(0);\n\n  return (\n    <g>\n      {/* Grid */}\n      <GridRows\n        scale={yScale}\n        width={width - margin.left - margin.right}\n        left={margin.left}\n        stroke=\"rgba(255,255,255,0.1)\"\n        strokeDasharray=\"3 3\"\n      />\n      <GridColumns\n        scale={xScale}\n        height={chartAreaHeight}\n        top={margin.top}\n        stroke=\"rgba(255,255,255,0.1)\"\n        strokeDasharray=\"3 3\"\n      />\n      {/* Equilibrium line */}\n      {Number.isFinite(zeroY) && (\n        <line\n          x1={margin.left}\n          x2={width - margin.right}\n          y1={zeroY}\n          y2={zeroY}\n          stroke=\"rgba(255,255,255,0.25)\"\n          strokeWidth={1}\n          strokeDasharray=\"4 2\"\n        />\n      )}\n\n      {/* Pressure lines */}\n      {visiblePressures.map((pressureId) => {\n        const colorIndex = pressureIds.indexOf(pressureId);\n        const color = PRESSURE_COLORS[colorIndex % PRESSURE_COLORS.length];\n\n        return (\n          <LinePath\n            key={pressureId}\n            data={data}\n            x={(d) => xScale(d.tick)}\n            y={(d) => yScale(d[pressureId] ?? 0)}\n            stroke={color}\n            strokeWidth={2}\n            strokeLinecap=\"round\"\n          />\n        );\n      })}\n\n      {/* Y Axis */}\n      <AxisLeft\n        scale={yScale}\n        left={margin.left}\n        stroke=\"#93c5fd\"\n        tickStroke=\"#93c5fd\"\n        tickLabelProps={() => ({\n          fill: \"#93c5fd\",\n          fontSize: 11,\n          textAnchor: \"end\",\n          dy: \"0.33em\",\n          dx: -4,\n        })}\n        numTicks={5}\n        hideAxisLine={false}\n        hideTicks={false}\n      />\n\n      {/* X Axis - positioned at chart bottom */}\n      <AxisBottom\n        scale={xScale}\n        top={height}\n        stroke=\"#93c5fd\"\n        tickStroke=\"#93c5fd\"\n        tickLabelProps={() => ({\n          fill: \"#93c5fd\",\n          fontSize: 11,\n          textAnchor: \"middle\",\n          dy: 4,\n        })}\n        numTicks={Math.min(10, data.length)}\n        hideAxisLine={false}\n        hideTicks={false}\n      />\n    </g>\n  );\n}", "parameters": [{"name": "{\n  data,\n  pressureIds,\n  hiddenPressures,\n  xScale,\n  yScale,\n  margin,\n  height, // This is chartBottom, not total height\n  width,\n}", "type": "{ data: any; pressureIds: any; hiddenPressures: any; xScale: any; yScale: any; margin: any; height: any; width: any; }", "optional": false}], "returnType": "import(\"/home/tsonu/src/the-canonry/node_modules/.pnpm/@types+react@19.2.14/node_modules/@types/react/jsx-runtime\").JSX.Element", "jsxTree": {"tag": "g", "children": [{"tag": "GridRows", "children": [], "isMap": false, "isConditional": false}, {"tag": "GridColumns", "children": [], "isMap": false, "isConditional": false}, {"tag": "line", "children": [], "isMap": false, "isConditional": true}, {"tag": "LinePath", "children": [], "isMap": true, "isConditional": false}, {"tag": "AxisLeft", "children": [], "isMap": false, "isConditional": false}, {"tag": "AxisBottom", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, "hookCalls": [], "imports": [], "storeAccess": []}, {"id": "apps/lore-weave/webui/src/components/dashboard/trace/index.js::EventSwimlanes", "name": "EventSwimlanes", "kind": "component", "filePath": "apps/lore-weave/webui/src/components/dashboard/trace/index.js", "sourceCode": "/**\n * Main swimlanes component\n */\nexport default function EventSwimlanes({\n  events,\n  xScale,\n  y,\n  width,\n  margin,\n  hoveredEventId,\n  selectedEventId,\n  onEventHover,\n  onEventClick,\n}) {\n  const { height, gap, types } = SWIMLANE_CONFIG;\n\n  return (\n    <g>\n      {/* Swimlanes separator line */}\n      <line\n        x1={margin.left}\n        y1={y - 4}\n        x2={width - margin.right}\n        y2={y - 4}\n        stroke=\"rgba(255,255,255,0.1)\"\n        strokeWidth={1}\n      />\n\n      {/* Individual swimlanes */}\n      {types.map((type, i) => (\n        <Swimlane\n          key={type}\n          type={type}\n          events={events[type] || []}\n          xScale={xScale}\n          y={y + i * (height + gap)}\n          height={height}\n          margin={margin}\n          hoveredEventId={hoveredEventId}\n          selectedEventId={selectedEventId}\n          onEventHover={onEventHover}\n          onEventClick={onEventClick}\n        />\n      ))}\n    </g>\n  );\n}", "parameters": [{"name": "{\n  events,\n  xScale,\n  y,\n  width,\n  margin,\n  hoveredEventId,\n  selectedEventId,\n  onEventHover,\n  onEventClick,\n}", "type": "{ events: any; xScale: any; y: any; width: any; margin: any; hoveredEventId: any; selectedEventId: any; onEventHover: any; onEventClick: any; }", "optional": false}], "returnType": "import(\"/home/tsonu/src/the-canonry/node_modules/.pnpm/@types+react@19.2.14/node_modules/@types/react/jsx-runtime\").JSX.Element", "jsxTree": {"tag": "g", "children": [{"tag": "line", "children": [], "isMap": false, "isConditional": false}, {"tag": "Swimlane", "children": [], "isMap": true, "isConditional": false}], "isMap": false, "isConditional": false}, "hookCalls": [], "imports": [], "storeAccess": []}, {"id": "apps/lore-weave/webui/src/components/dashboard/trace/index.js::EraTimeline", "name": "EraTimeline", "kind": "component", "filePath": "apps/lore-weave/webui/src/components/dashboard/trace/index.js", "sourceCode": "/**\n * Main era timeline component\n */\nexport default function EraTimeline({ eraBoundaries, xScale, y, height, width, margin }) {\n  if (!eraBoundaries?.length) {\n    return null;\n  }\n\n  return (\n    <g>\n      {/* Timeline baseline */}\n      <line\n        x1={margin.left}\n        y1={y}\n        x2={width - margin.right}\n        y2={y}\n        stroke=\"rgba(255,255,255,0.2)\"\n        strokeWidth={1}\n      />\n\n      {/* Era segments */}\n      {eraBoundaries.map((era, i) => (\n        <EraSegment\n          key={`era-${i}`}\n          era={era}\n          index={i}\n          xScale={xScale}\n          y={y + 2}\n          height={height - 4}\n          isFirst={i === 0}\n          isLast={i === eraBoundaries.length - 1}\n        />\n      ))}\n\n      {/* Transition markers between eras */}\n      {eraBoundaries.slice(1).map((era, i) => (\n        <TransitionMarker key={`transition-${i}`} x={xScale(era.startTick)} y={y} height={height} />\n      ))}\n\n      {/* Timeline label */}\n      <text\n        x={margin.left - 8}\n        y={y + height / 2}\n        textAnchor=\"end\"\n        dominantBaseline=\"middle\"\n        fill=\"rgba(255,255,255,0.4)\"\n        fontSize={9}\n        fontWeight={500}\n      >\n        Eras\n      </text>\n    </g>\n  );\n}", "parameters": [{"name": "{ eraBoundaries, xScale, y, height, width, margin }", "type": "{ eraBoundaries: any; xScale: any; y: any; height: any; width: any; margin: any; }", "optional": false}], "returnType": "import(\"/home/tsonu/src/the-canonry/node_modules/.pnpm/@types+react@19.2.14/node_modules/@types/react/jsx-runtime\").JSX.Element", "jsxTree": {"tag": "g", "children": [{"tag": "line", "children": [], "isMap": false, "isConditional": false}, {"tag": "EraSegment", "children": [], "isMap": true, "isConditional": false}, {"tag": "TransitionMarker", "children": [], "isMap": true, "isConditional": false}, {"tag": "text", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": false}, "hookCalls": [], "imports": [], "storeAccess": []}, {"id": "apps/lore-weave/webui/src/components/dashboard/trace/index.js::TraceTooltip", "name": "TraceTooltip", "kind": "component", "filePath": "apps/lore-weave/webui/src/components/dashboard/trace/index.js", "sourceCode": "/**\n * Simple tooltip component\n */\nexport default function TraceTooltip({ tooltipData, tooltipLeft, tooltipTop, tooltipOpen }) {\n  if (!tooltipOpen || !tooltipData) return null;\n\n  return (\n    <TooltipWithBounds left={tooltipLeft} top={tooltipTop} className=\"tt-tooltip\">\n      {tooltipData.type === \"tick\" && (\n        <div>\n          <div className=\"tt-tick-header\">Tick {tooltipData.tick}</div>\n          {tooltipData.pressures?.map((p, i) => (\n            <div key={i} className=\"tt-pressure-row\">\n              <span className=\"tt-pressure-name\" style={{ '--tt-pressure-color': p.color }}>{p.name}</span>\n              <span>{p.value?.toFixed(1)}</span>\n            </div>\n          ))}\n        </div>\n      )}\n      {tooltipData.type === \"event\" && (\n        <div>\n          <div className=\"tt-event-header\">\n            {tooltipData.eventType === \"template\" && \"\u25b2 \"}\n            {tooltipData.eventType === \"system\" && \"\u25c6 \"}\n            {tooltipData.eventType === \"action\" && \"\u25cf \"}\n            {tooltipData.label}\n          </div>\n          <div className=\"tt-event-tick\">Tick {tooltipData.tick}</div>\n        </div>\n      )}\n    </TooltipWithBounds>\n  );\n}", "parameters": [{"name": "{ tooltipData, tooltipLeft, tooltipTop, tooltipOpen }", "type": "{ tooltipData: any; tooltipLeft: any; tooltipTop: any; tooltipOpen: any; }", "optional": false}], "returnType": "import(\"/home/tsonu/src/the-canonry/node_modules/.pnpm/@types+react@19.2.14/node_modules/@types/react/jsx-runtime\").JSX.Element", "jsxTree": {"tag": "TooltipWithBounds", "children": [{"tag": "div", "children": [{"tag": "div", "children": [], "isMap": false, "isConditional": false}, {"tag": "div", "children": [{"tag": "span", "children": [], "isMap": false, "isConditional": false}, {"tag": "span", "children": [], "isMap": false, "isConditional": false}], "isMap": true, "isConditional": false}], "isMap": false, "isConditional": true}, {"tag": "div", "children": [{"tag": "div", "children": [], "isMap": false, "isConditional": false}, {"tag": "div", "children": [], "isMap": false, "isConditional": false}], "isMap": false, "isConditional": true}], "isMap": false, "isConditional": false}, "hookCalls": [], "imports": [], "storeAccess": []}, {"id": "apps/lore-weave/webui/src/components/dashboard/trace/TraceTooltip.jsx::useTraceTooltip", "name": "useTraceTooltip", "kind": "hook", "filePath": "apps/lore-weave/webui/src/components/dashboard/trace/TraceTooltip.jsx", "sourceCode": "/**\n * Tooltip hook and component for trace visualization\n */\nexport function useTraceTooltip() {\n  return useTooltip();\n}", "parameters": [], "returnType": "import(\"/home/tsonu/src/the-canonry/node_modules/.pnpm/@visx+tooltip@3.12.0_react-dom@19.2.4_react@19.2.4__react@19.2.4/node_modules/@visx/tooltip/lib/hooks/useTooltip\").UseTooltipParams<{}>", "jsxTree": null, "hookCalls": [{"name": "useTooltip", "count": 1}], "imports": [{"source": "react", "specifiers": ["React"], "category": "framework"}, {"source": "prop-types", "specifiers": ["PropTypes"], "category": "external"}, {"source": "@visx/tooltip", "specifiers": ["useTooltip", "TooltipWithBounds"], "category": "external"}, {"source": "./TraceTooltip.css", "specifiers": [], "category": "internal"}], "storeAccess": []}]