[
  {"unitId": "apps/illuminator/webui/src/lib/db/chronicleRepository.ts::updateChronicleComparisonReport", "purpose": "Persists a version comparison report text and optional combine instructions onto a chronicle record in the database"},
  {"unitId": "apps/illuminator/webui/src/lib/db/chronicleRepository.ts::updateChronicleTemporalCheckReport", "purpose": "Saves a temporal consistency check report onto a chronicle record with a generation timestamp"},
  {"unitId": "apps/illuminator/webui/src/lib/db/chronicleRepository.ts::updateChronicleQuickCheckReport", "purpose": "Stores a quick check report object on a chronicle record, recording the time it was generated"},
  {"unitId": "apps/illuminator/webui/src/lib/db/chronicleRepository.ts::updateChronicleFactCoverage", "purpose": "Persists a fact coverage analysis report onto a chronicle, tracking which canon facts are represented in the narrative"},
  {"unitId": "apps/illuminator/webui/src/lib/db/chronicleRepository.ts::repairFactCoverageWasFaceted", "purpose": "One-shot migration that recomputes the wasFaceted flag on all stored fact coverage reports using authoritative facet IDs instead of legacy fuzzy text matching"},
  {"unitId": "apps/illuminator/webui/src/lib/db/chronicleRepository.ts::computeCorpusFactStrength", "purpose": "Aggregates fact coverage reports across all chronicles in a simulation run to produce a weighted strength score (0â€“100) per canon fact"},
  {"unitId": "apps/illuminator/webui/src/lib/db/chronicleRepository.ts::computeAnnotationReinforcementCounts", "purpose": "Counts how many times each canon fact has been reinforced across chronicle and entity annotations in a simulation run"},
  {"unitId": "apps/illuminator/webui/src/lib/db/chronicleRepository.ts::updateChronicleTertiaryCast", "purpose": "Saves detected tertiary cast entries (entity mentions not in the declared cast) onto a chronicle record"},
  {"unitId": "apps/illuminator/webui/src/lib/db/chronicleRepository.ts::updateChronicleHistorianPrep", "purpose": "Stores a historian preparation brief on a chronicle to guide narrative generation"},
  {"unitId": "apps/illuminator/webui/src/lib/db/chronicleRepository.ts::updateChronicleSummary", "purpose": "Writes an AI-generated summary and associated cost metadata onto a chronicle record, optionally targeting a specific version"},
  {"unitId": "apps/illuminator/webui/src/lib/db/chronicleRepository.ts::updateChronicleTitle", "purpose": "Stores AI-generated title candidates in pending fields on a chronicle, requiring explicit user acceptance before the title is committed"},
  {"unitId": "apps/illuminator/webui/src/lib/db/chronicleRepository.ts::acceptPendingTitle", "purpose": "Promotes a pending AI-generated title to the active chronicle title, clearing the pending fields"},
  {"unitId": "apps/illuminator/webui/src/lib/db/chronicleRepository.ts::rejectPendingTitle", "purpose": "Discards a pending AI-generated title from a chronicle without changing the current active title"},
  {"unitId": "apps/illuminator/webui/src/lib/db/chronicleRepository.ts::updateChronicleImageRefs", "purpose": "Persists AI-generated image reference descriptors and cost metadata onto a chronicle record"},
  {"unitId": "apps/illuminator/webui/src/lib/db/chronicleRepository.ts::updateChronicleImageRef", "purpose": "Updates the status, generated image ID, error, and layout fields of a single image reference within a chronicle"},
  {"unitId": "apps/illuminator/webui/src/lib/db/chronicleRepository.ts::applyImageRefSelections", "purpose": "Applies user decisions (reuse, regenerate, or skip) to image refs after a chronicle version change, then updates the target version pointer"},
  {"unitId": "apps/illuminator/webui/src/lib/db/chronicleRepository.ts::updateChronicleCoverImage", "purpose": "Saves an AI-generated cover image scene description and generation cost onto a chronicle record"},
  {"unitId": "apps/illuminator/webui/src/lib/db/chronicleRepository.ts::updateChronicleCoverImageStatus", "purpose": "Updates the generation status and result image ID or error of a chronicle's cover image after image generation completes"},
  {"unitId": "apps/illuminator/webui/src/lib/db/chronicleRepository.ts::updateChronicleTemporalContext", "purpose": "Sets or clears the temporal context (era dates and framing) on a chronicle record"},
  {"unitId": "apps/illuminator/webui/src/lib/db/chronicleRepository.ts::refreshEraSummariesInChronicles", "purpose": "Propagates updated era summary strings into all chronicles for a simulation run, patching temporal context and perspective synthesis focal era fields"},
  {"unitId": "apps/illuminator/webui/src/lib/db/chronicleRepository.ts::acceptChronicle", "purpose": "Marks a chronicle as fully accepted by the user, locking in the active version's content and recording acceptance metadata"},
  {"unitId": "apps/illuminator/webui/src/lib/db/chronicleRepository.ts::unpublishChronicle", "purpose": "Reverts an accepted chronicle back to assembly_ready status, clearing its final content and acceptance metadata"},
  {"unitId": "apps/illuminator/webui/src/lib/db/chronicleRepository.ts::updateChronicleActiveVersion", "purpose": "Sets which generation version will be used when a chronicle is accepted, rejecting the change if the chronicle is already published"},
  {"unitId": "apps/illuminator/webui/src/lib/db/chronicleRepository.ts::updateChronicleCombineInstructions", "purpose": "Sets or clears the user-provided instructions that guide how multiple chronicle versions are combined"},
  {"unitId": "apps/illuminator/webui/src/lib/db/chronicleRepository.ts::deleteChronicleVersion", "purpose": "Removes a specific generation version from a chronicle's history, switching to the most recent remaining version if the deleted version was active"},
  {"unitId": "apps/illuminator/webui/src/lib/db/chronicleRepository.ts::updateChronicleEntityBackportStatus", "purpose": "Merges per-entity backport status entries into a chronicle's entityBackportStatus map, tracking which entity descriptions have been backported"},
  {"unitId": "apps/illuminator/webui/src/lib/db/chronicleRepository.ts::updateChronicleHistorianNotes", "purpose": "Saves historian review notes, optional reinforced fact IDs, and the prompts used during review onto a chronicle record"},
  {"unitId": "apps/illuminator/webui/src/lib/db/chronicleRepository.ts::startChronicleValidation", "purpose": "Transitions a chronicle's status to 'validating' after the user approves the assembled content for review"},
  {"unitId": "apps/illuminator/webui/src/lib/db/chronicleRepository.ts::batchUpdateChronicleEraYears", "purpose": "Bulk-assigns historian-determined era year values and reasoning to multiple chronicles in a single database operation"},
  {"unitId": "apps/illuminator/webui/src/lib/db/chronicleRepository.ts::getChronicle", "purpose": "Retrieves a single chronicle record by ID, migrating legacy version data if needed"},
  {"unitId": "apps/illuminator/webui/src/lib/db/chronicleRepository.ts::getChroniclesForSimulation", "purpose": "Fetches all chronicle records associated with a simulation run, migrating any legacy version fields in bulk"},
  {"unitId": "apps/illuminator/webui/src/lib/db/chronicleRepository.ts::deleteChronicle", "purpose": "Permanently removes a single chronicle record from the database"},
  {"unitId": "apps/illuminator/webui/src/lib/db/chronicleRepository.ts::deleteChroniclesForSimulation", "purpose": "Deletes all chronicle records for a simulation run and returns the count removed"},
  {"unitId": "apps/illuminator/webui/src/lib/db/chronicleRepository.ts::putChronicle", "purpose": "Writes a fully-updated chronicle record back to the database, used by entity rename flows that patch chronicle content"},
  {"unitId": "apps/illuminator/webui/src/lib/db/chronicleRepository.ts::getEntityUsageStats", "purpose": "Aggregates how many times each entity appears as a cast member across all chronicles in a simulation run"},
  {"unitId": "apps/illuminator/webui/src/lib/db/chronicleRepository.ts::getNarrativeStyleUsageStats", "purpose": "Aggregates how many times each narrative style has been used across chronicles in a simulation run"},
  {"unitId": "apps/illuminator/webui/src/lib/db/chronicleRepository.ts::reconcileBackportStatusFromEntities", "purpose": "Rebuilds the entityBackportStatus map on each chronicle by comparing declared cast members against actual entity chronicle backrefs"},
  {"unitId": "apps/illuminator/webui/src/lib/db/chronicleRepository.ts::resetAllBackportFlags", "purpose": "Clears all entityBackportStatus entries on every chronicle in a simulation run, returning the count of modified chronicles"},
  {"unitId": "apps/illuminator/webui/src/lib/db/chronicleRepository.ts::updateChronicleToneRanking", "purpose": "Saves an AI-generated tone ranking (ordered triples with rationale) onto a chronicle record"},
  {"unitId": "apps/illuminator/webui/src/lib/db/chronicleRepository.ts::updateChronicleAssignedTone", "purpose": "Sets the final historian tone designation on a chronicle record"},
  {"unitId": "apps/illuminator/webui/src/lib/db/chronicleSelectors.ts::getChronicleFromStore", "purpose": "Retrieves a chronicle record synchronously from the in-memory Zustand cache for use in event handlers and callbacks"},
  {"unitId": "apps/illuminator/webui/src/lib/db/contentTreeRepository.ts::loadTree", "purpose": "Loads the content tree state for a given project and simulation run from the database"},
  {"unitId": "apps/illuminator/webui/src/lib/db/contentTreeRepository.ts::saveTree", "purpose": "Persists a content tree state record to the database"},
  {"unitId": "apps/illuminator/webui/src/lib/db/contentTreeRepository.ts::deleteTree", "purpose": "Removes the content tree record for a specific project and simulation run from the database"},
  {"unitId": "apps/illuminator/webui/src/lib/db/coordinateStateRepository.ts::getCoordinateState", "purpose": "Retrieves the stored coordinate state for a simulation run from the database"},
  {"unitId": "apps/illuminator/webui/src/lib/db/coordinateStateRepository.ts::upsertCoordinateState", "purpose": "Creates or replaces the coordinate state for a simulation run in the database with an updated timestamp"},
  {"unitId": "apps/illuminator/webui/src/lib/db/costRepository.ts::generateCostId", "purpose": "Generates a unique cost record ID combining the current timestamp and a random UUID fragment"},
  {"unitId": "apps/illuminator/webui/src/lib/db/costRepository.ts::createCostRecord", "purpose": "Constructs a typed cost record object from input fields, supplying generated defaults for ID and timestamp if not provided"},
  {"unitId": "apps/illuminator/webui/src/lib/db/costRepository.ts::saveCostRecord", "purpose": "Persists a cost record to the database with debug logging around the write"},
  {"unitId": "apps/illuminator/webui/src/lib/db/costRepository.ts::saveCostRecordWithDefaults", "purpose": "Creates a cost record from raw input and immediately saves it to the database in one step"},
  {"unitId": "apps/illuminator/webui/src/lib/db/costRepository.ts::getCostsForProject", "purpose": "Retrieves all cost records associated with a specific project from the database"},
  {"unitId": "apps/illuminator/webui/src/lib/db/costRepository.ts::getCostsForSimulation", "purpose": "Retrieves all cost records associated with a specific simulation run from the database"},
  {"unitId": "apps/illuminator/webui/src/lib/db/costRepository.ts::getAllCosts", "purpose": "Retrieves every cost record stored in the database"},
  {"unitId": "apps/illuminator/webui/src/lib/db/costRepository.ts::getCostsInRange", "purpose": "Fetches cost records whose timestamps fall within a given start and end time range"},
  {"unitId": "apps/illuminator/webui/src/lib/db/costRepository.ts::summarizeCosts", "purpose": "Aggregates an array of cost records into totals and breakdowns by operation type and model"},
  {"unitId": "apps/illuminator/webui/src/lib/db/costRepository.ts::clearAllCosts", "purpose": "Deletes all cost records from the database"},
  {"unitId": "apps/illuminator/webui/src/lib/db/costRepository.ts::getCostCount", "purpose": "Returns the total number of cost records currently stored in the database"},
  {"unitId": "apps/illuminator/webui/src/lib/db/dynamicsRepository.ts::generateRunId", "purpose": "Generates a unique dynamics run ID combining the current timestamp and a random UUID fragment"},
  {"unitId": "apps/illuminator/webui/src/lib/db/dynamicsRepository.ts::createDynamicsRun", "purpose": "Creates and persists a new dynamics generation run record with pending status and zeroed cost accumulators"},
  {"unitId": "apps/illuminator/webui/src/lib/db/dynamicsRepository.ts::getDynamicsRun", "purpose": "Retrieves a single dynamics run record by its run ID"},
  {"unitId": "apps/illuminator/webui/src/lib/db/dynamicsRepository.ts::updateDynamicsRun", "purpose": "Applies partial field updates to an existing dynamics run record and saves it back to the database"},
  {"unitId": "apps/illuminator/webui/src/lib/db/dynamicsRepository.ts::deleteDynamicsRun", "purpose": "Permanently removes a dynamics run record from the database"},
  {"unitId": "apps/illuminator/webui/src/lib/db/enrichmentQueueBridge.ts::registerQueue", "purpose": "Registers the enqueue and cancel callback functions that connect the enrichment worker to other parts of the system"},
  {"unitId": "apps/illuminator/webui/src/lib/db/enrichmentQueueBridge.ts::getEnqueue", "purpose": "Returns the registered enqueue function, throwing if it has not yet been registered"},
  {"unitId": "apps/illuminator/webui/src/lib/db/enrichmentQueueBridge.ts::getCancel", "purpose": "Returns the registered cancel function, throwing if it has not yet been registered"},
  {"unitId": "apps/illuminator/webui/src/lib/db/entityNav.ts::buildEntityNavItem", "purpose": "Builds a compact navigation item summary from a persisted entity, including enrichment status flags and cost metadata for display in entity lists"},
  {"unitId": "apps/illuminator/webui/src/lib/db/entityRepository.ts::isSeeded", "purpose": "Checks whether entities have already been seeded into the database for a given simulation run"},
  {"unitId": "apps/illuminator/webui/src/lib/db/entityRepository.ts::seedEntities", "purpose": "Bulk-writes world entities into the database for a simulation run, stamping each with the run ID"},
  {"unitId": "apps/illuminator/webui/src/lib/db/entityRepository.ts::createEntity", "purpose": "Creates a single manually-authored entity with a collision-safe prefixed ID and persists it to the database"},
  {"unitId": "apps/illuminator/webui/src/lib/db/entityRepository.ts::deleteEntity", "purpose": "Deletes a manually-created entity from the database, refusing to delete simulation-generated entities"},
  {"unitId": "apps/illuminator/webui/src/lib/db/entityRepository.ts::patchEntitiesFromHardState", "purpose": "Inserts missing entities from a hard state snapshot and fills null fields on existing entities without overwriting enrichment data"},
  {"unitId": "apps/illuminator/webui/src/lib/db/entityRepository.ts::getEntity", "purpose": "Retrieves a single persisted entity by its ID from the database"},
  {"unitId": "apps/illuminator/webui/src/lib/db/entityRepository.ts::getEntitiesByIds", "purpose": "Bulk-fetches multiple persisted entities by their IDs, filtering out any that were not found"},
  {"unitId": "apps/illuminator/webui/src/lib/db/entityRepository.ts::getEntitiesForRun", "purpose": "Retrieves all persisted entities belonging to a specific simulation run"},
  {"unitId": "apps/illuminator/webui/src/lib/db/entityRepository.ts::getEntityIdsForRun", "purpose": "Returns only the primary key IDs of all entities for a simulation run without loading full records"},
  {"unitId": "apps/illuminator/webui/src/lib/db/entityRepository.ts::getEntitiesByKind", "purpose": "Retrieves all persisted entities of a specific kind within a simulation run using a compound index"},
  {"unitId": "apps/illuminator/webui/src/lib/db/entityRepository.ts::updateEntityField", "purpose": "Updates a single named field on a persisted entity record in the database"},
  {"unitId": "apps/illuminator/webui/src/lib/db/entityRepository.ts::updateEntityFields", "purpose": "Applies a partial field set update to a persisted entity record in the database"},
  {"unitId": "apps/illuminator/webui/src/lib/db/entityRepository.ts::applyRename", "purpose": "Renames a target entity and applies cascading text patches to other entities that reference the old name within a database transaction"},
  {"unitId": "apps/illuminator/webui/src/lib/db/entityRepository.ts::applyDescriptionResult", "purpose": "Applies an AI-generated description enrichment result to an entity, pushing the current description to history before overwriting"},
  {"unitId": "apps/illuminator/webui/src/lib/db/entityRepository.ts::applyVisualThesisResult", "purpose": "Updates only the visual thesis and visual trait fields on an entity's enrichment, preserving description, summary, and aliases"},
  {"unitId": "apps/illuminator/webui/src/lib/db/entityRepository.ts::applyImageResult", "purpose": "Merges an image enrichment result from the enrichment worker into an entity's enrichment data"},
  {"unitId": "apps/illuminator/webui/src/lib/db/entityRepository.ts::applyEntityChronicleResult", "purpose": "Merges an entity chronicle enrichment result from the worker into an entity's enrichment data"},
  {"unitId": "apps/illuminator/webui/src/lib/db/entityRepository.ts::assignImage", "purpose": "Associates an existing image library entry with an entity by updating its image enrichment fields"},
  {"unitId": "apps/illuminator/webui/src/lib/db/entityRepository.ts::updateDescriptionManual", "purpose": "Manually updates an entity's description, pushing the previous version to history with a 'manual' source tag to prevent enrichment overwrites"},
  {"unitId": "apps/illuminator/webui/src/lib/db/entityRepository.ts::updateSummaryManual", "purpose": "Manually updates an entity's summary and locks it to prevent AI enrichment from overwriting the user's text"},
  {"unitId": "apps/illuminator/webui/src/lib/db/entityRepository.ts::undoDescription", "purpose": "Reverts an entity's description to the previous entry in its description history stack"},
  {"unitId": "apps/illuminator/webui/src/lib/db/entityRepository.ts::restoreDescriptionFromHistory", "purpose": "Restores a specific historical description entry as the active description, pushing the current one onto the history stack"},
  {"unitId": "apps/illuminator/webui/src/lib/db/entityRepository.ts::updateBackrefs", "purpose": "Replaces the chronicle backref list on an entity's enrichment, recording which chronicles reference this entity"},
  {"unitId": "apps/illuminator/webui/src/lib/db/entityRepository.ts::updateAliases", "purpose": "Updates the text aliases list on an entity's enrichment data"},
  {"unitId": "apps/illuminator/webui/src/lib/db/entityRepository.ts::applyRevisionPatches", "purpose": "Applies description revision patches from summary revision, lore backport, or copy-edit runs, preserving history and returning IDs of modified entities"},
  {"unitId": "apps/illuminator/webui/src/lib/db/entityRepository.ts::revalidateBackrefs", "purpose": "Recomputes chronicle backrefs for a set of entities after description changes, using anchor phrases or fuzzy matching to find chronicle references"},
  {"unitId": "apps/illuminator/webui/src/lib/db/entityRepository.ts::setHistorianNotes", "purpose": "Stores historian review notes and optional reinforced fact IDs on an entity's enrichment data"},
  {"unitId": "apps/illuminator/webui/src/lib/db/entityRepository.ts::resetEntitiesToPreBackportState", "purpose": "Rolls back entity descriptions to their pre-backport state by finding the first lore-backport history entry and truncating all subsequent history"},
  {"unitId": "apps/illuminator/webui/src/lib/db/entityRepository.ts::deleteEntitiesForRun", "purpose": "Deletes all persisted entity records associated with a simulation run from the database"},
  {"unitId": "apps/illuminator/webui/src/lib/db/entityRepository.ts::convertLongEditionsToLegacy", "purpose": "Relabels historian-edition description history entries as legacy-copy-edit to allow entities to start a fresh edition cycle"},
  {"unitId": "apps/illuminator/webui/src/lib/db/eraNarrativeNav.ts::buildEraNarrativeNavItem", "purpose": "Builds a compact navigation summary for an era narrative, exposing status, word count, cost, and image fields for display in a list"},
  {"unitId": "apps/illuminator/webui/src/lib/db/eraNarrativeRepository.ts::generateEraNarrativeId", "purpose": "Generates a unique era narrative ID combining the current timestamp and a random UUID fragment"},
  {"unitId": "apps/illuminator/webui/src/lib/db/eraNarrativeRepository.ts::generateVersionId", "purpose": "Generates a unique era narrative version ID combining the current timestamp and a random UUID fragment"},
  {"unitId": "apps/illuminator/webui/src/lib/db/eraNarrativeRepository.ts::createEraNarrative", "purpose": "Persists a new era narrative record to the database and returns it"},
  {"unitId": "apps/illuminator/webui/src/lib/db/eraNarrativeRepository.ts::getEraNarrative", "purpose": "Retrieves a single era narrative record by its ID from the database"},
  {"unitId": "apps/illuminator/webui/src/lib/db/eraNarrativeRepository.ts::getEraNarrativesForEra", "purpose": "Retrieves all era narrative records associated with a specific era within a simulation run"},
  {"unitId": "apps/illuminator/webui/src/lib/db/eraNarrativeRepository.ts::getEraNarrativesForSimulation", "purpose": "Retrieves all era narrative records for an entire simulation run"},
  {"unitId": "apps/illuminator/webui/src/lib/db/eraNarrativeRepository.ts::updateEraNarrative", "purpose": "Applies partial field updates to an era narrative record and saves it back to the database"},
  {"unitId": "apps/illuminator/webui/src/lib/db/eraNarrativeRepository.ts::deleteEraNarrative", "purpose": "Permanently removes an era narrative record from the database"},
  {"unitId": "apps/illuminator/webui/src/lib/db/eraNarrativeRepository.ts::deleteEraNarrativeVersion", "purpose": "Removes a specific content version from an era narrative's version history, refusing to delete the base generate version"},
  {"unitId": "apps/illuminator/webui/src/lib/db/eraNarrativeRepository.ts::setEraNarrativeActiveVersion", "purpose": "Sets the active display version for an era narrative, updating which content version is shown to the user"},
  {"unitId": "apps/illuminator/webui/src/lib/db/eraNarrativeRepository.ts::updateEraNarrativeCoverImage", "purpose": "Saves an AI-generated cover image description and generation cost onto an era narrative record"},
  {"unitId": "apps/illuminator/webui/src/lib/db/eraNarrativeRepository.ts::updateEraNarrativeCoverImageStatus", "purpose": "Updates the generation status and result image ID or error of an era narrative's cover image"},
  {"unitId": "apps/illuminator/webui/src/lib/db/eraNarrativeRepository.ts::updateEraNarrativeImageRefs", "purpose": "Saves AI-generated image reference descriptors and cost metadata onto an era narrative record"},
  {"unitId": "apps/illuminator/webui/src/lib/db/eraNarrativeRepository.ts::updateEraNarrativeImageRefStatus", "purpose": "Updates the generation status and result image ID or error of a specific image reference within an era narrative"},
  {"unitId": "apps/illuminator/webui/src/lib/db/eraNarrativeRepository.ts::updateEraNarrativeImageRefField", "purpose": "Updates layout and anchor fields (anchor text, size, justification) on a specific image reference within an era narrative"},
  {"unitId": "apps/illuminator/webui/src/lib/db/eraNarrativeRepository.ts::resolveActiveContent", "purpose": "Returns the active version's content string and version list for an era narrative, falling back to the legacy narrative field for older records"},
  {"unitId": "apps/illuminator/webui/src/lib/db/eventRepository.ts::isNarrativeEventsSeeded", "purpose": "Checks whether narrative events have already been seeded into the database for a given simulation run"},
  {"unitId": "apps/illuminator/webui/src/lib/db/eventRepository.ts::seedNarrativeEvents", "purpose": "Bulk-writes narrative events into the database for a simulation run, stamping each with the run ID"},
  {"unitId": "apps/illuminator/webui/src/lib/db/eventRepository.ts::patchNarrativeEvents", "purpose": "Inserts only missing narrative events for a simulation run, leaving existing records untouched"},
  {"unitId": "apps/illuminator/webui/src/lib/db/eventRepository.ts::getNarrativeEventsForRun", "purpose": "Retrieves all narrative events persisted for a specific simulation run"},
  {"unitId": "apps/illuminator/webui/src/lib/db/eventRepository.ts::getNarrativeEvent", "purpose": "Retrieves a single narrative event by its ID from the database"},
  {"unitId": "apps/illuminator/webui/src/lib/db/eventRepository.ts::applyEventPatches", "purpose": "Applies text replacement patches to narrative event records after a rename operation, returning the IDs of all modified events"},
  {"unitId": "apps/illuminator/webui/src/lib/db/eventRepository.ts::deleteEventsForRun", "purpose": "Deletes all narrative event records associated with a simulation run from the database"},
  {"unitId": "apps/illuminator/webui/src/lib/db/historianRepository.ts::generateHistorianRunId", "purpose": "Generates a unique historian run ID combining the current timestamp and a random UUID fragment"},
  {"unitId": "apps/illuminator/webui/src/lib/db/historianRepository.ts::createHistorianRun", "purpose": "Persists a new historian run record to the database and returns it"},
  {"unitId": "apps/illuminator/webui/src/lib/db/historianRepository.ts::getHistorianRun", "purpose": "Retrieves a single historian run record by its run ID from the database"},
  {"unitId": "apps/illuminator/webui/src/lib/db/historianRepository.ts::updateHistorianRun", "purpose": "Applies partial field updates to an existing historian run record and saves it back to the database"},
  {"unitId": "apps/illuminator/webui/src/lib/db/historianRepository.ts::deleteHistorianRun", "purpose": "Permanently removes a historian run record from the database"},
  {"unitId": "apps/illuminator/webui/src/lib/db/historianRunHelpers.ts::extractReinforcedFactIds", "purpose": "Parses a historian review context JSON string to extract the list of canon fact IDs targeted for reinforcement"},
  {"unitId": "apps/illuminator/webui/src/lib/db/historianRunHelpers.ts::sleep", "purpose": "Returns a promise that resolves after a specified number of milliseconds, used for polling delays"},
  {"unitId": "apps/illuminator/webui/src/lib/db/historianRunHelpers.ts::dispatchReviewTask", "purpose": "Enqueues a historian review task to the enrichment worker by submitting a synthetic entity task with the run ID"},
  {"unitId": "apps/illuminator/webui/src/lib/db/historianRunHelpers.ts::pollReviewCompletion", "purpose": "Polls a historian run at fixed intervals until it reaches a completed or failed state, supporting cancellation via callback"},
  {"unitId": "apps/illuminator/webui/src/lib/db/imageRepository.ts::generateImageId", "purpose": "Generates a unique image ID by combining the entity ID and the current timestamp"},
  {"unitId": "apps/illuminator/webui/src/lib/db/imageRepository.ts::classifyAspect", "purpose": "Classifies an image's aspect ratio as portrait, landscape, or square based on its pixel dimensions"},
  {"unitId": "apps/illuminator/webui/src/lib/db/imageRepository.ts::extractImageDimensions", "purpose": "Extracts the pixel width, height, and aspect ratio classification from an image blob using createImageBitmap"},
  {"unitId": "apps/illuminator/webui/src/lib/db/imageRepository.ts::saveImage", "purpose": "Persists an image blob and its associated metadata record to the database, deriving dimensions and aspect classification"},
  {"unitId": "apps/illuminator/webui/src/lib/db/imageRepository.ts::deleteImage", "purpose": "Atomically deletes both the image metadata and blob records for a given image ID"},
  {"unitId": "apps/illuminator/webui/src/lib/db/imageRepository.ts::searchImages", "purpose": "Returns a paginated list of image metadata records optionally filtered by project ID and text search against entity name and prompt fields"},
  {"unitId": "apps/illuminator/webui/src/lib/db/imageRepository.ts::getImageDataUrl", "purpose": "Loads an image blob by ID and converts it to a base64 data URL for embedding in the UI"},
  {"unitId": "apps/illuminator/webui/src/lib/db/imageRepository.ts::loadImage", "purpose": "Loads an image by ID and creates an object URL for display, returning combined metadata and URL or null if not found"},
  {"unitId": "apps/illuminator/webui/src/lib/db/imageRepository.ts::getImageBlob", "purpose": "Retrieves the raw image blob for a given image ID from the database"},
  {"unitId": "apps/illuminator/webui/src/lib/db/imageRepository.ts::getAllImages", "purpose": "Retrieves metadata for all stored images sorted newest first, without loading blob data"},
  {"unitId": "apps/illuminator/webui/src/lib/db/imageRepository.ts::deleteImages", "purpose": "Atomically bulk-deletes both metadata and blob records for a set of image IDs"},
  {"unitId": "apps/illuminator/webui/src/lib/db/imageRepository.ts::getStorageStats", "purpose": "Computes total image count and storage size across all projects, broken down per project"},
  {"unitId": "apps/illuminator/webui/src/lib/db/imageRepository.ts::getImageFilterOptions", "purpose": "Returns unique sorted values for a given metadata field across all images, for populating filter dropdowns"},
  {"unitId": "apps/illuminator/webui/src/lib/db/imageRepository.ts::searchImagesWithFilters", "purpose": "Searches image metadata using rich filters for entity kind, culture, model, chronicle, and text, returning results without blob data"},
  {"unitId": "apps/illuminator/webui/src/lib/db/imageRepository.ts::searchChronicleImages", "purpose": "Returns paginated image metadata filtered by project and optionally by chronicle or image ref ID, using indexed queries for performance"},
  {"unitId": "apps/illuminator/webui/src/lib/db/imageRepository.ts::formatBytes", "purpose": "Converts a raw byte count to a human-readable string with appropriate unit suffix (B, KB, MB, GB)"},
  {"unitId": "apps/illuminator/webui/src/lib/db/imageRepository.ts::exportImagePrompts", "purpose": "Exports all image prompt data (without blobs) as a structured array for external analysis"},
  {"unitId": "apps/illuminator/webui/src/lib/db/imageRepository.ts::downloadImagePromptExport", "purpose": "Exports image prompt data to a JSON file and triggers a browser download of that file"},
  {"unitId": "apps/illuminator/webui/src/lib/db/indexComputation.ts::computeRunIndexes", "purpose": "Computes derived indexes for a simulation run including prominence scale thresholds and era temporal ordering from the entity set"},
  {"unitId": "apps/illuminator/webui/src/lib/db/indexRepository.ts::getRunIndexes", "purpose": "Retrieves the computed index record for a simulation run from the database"},
  {"unitId": "apps/illuminator/webui/src/lib/db/indexRepository.ts::upsertRunIndexes", "purpose": "Creates or replaces the computed index record for a simulation run in the database"},
  {"unitId": "apps/illuminator/webui/src/lib/db/indexRepository.ts::deleteRunIndexes", "purpose": "Removes the computed index record for a simulation run from the database"},
  {"unitId": "apps/illuminator/webui/src/lib/db/migrateFromLegacyDbs.ts::migrateFromLegacyDbs", "purpose": "Runs all legacy database migrations from old Canonry IndexedDB stores into the current unified database, skipping already-migrated databases via localStorage tracking"},
  {"unitId": "apps/illuminator/webui/src/lib/db/pageLayoutRepository.ts::getPageLayout", "purpose": "Retrieves a page layout override for a specific page within a simulation run, or null if none exists"},
  {"unitId": "apps/illuminator/webui/src/lib/db/pageLayoutRepository.ts::putPageLayout", "purpose": "Creates or replaces a page layout override record in the database"},
  {"unitId": "apps/illuminator/webui/src/lib/db/pageLayoutRepository.ts::deletePageLayout", "purpose": "Removes the page layout override for a specific page within a simulation run"},
  {"unitId": "apps/illuminator/webui/src/lib/db/pageLayoutRepository.ts::getAllPageLayouts", "purpose": "Retrieves all page layout overrides for a simulation run as an array"},
  {"unitId": "apps/illuminator/webui/src/lib/db/pageLayoutRepository.ts::getPageLayoutMap", "purpose": "Retrieves all page layout overrides for a simulation run as a Map keyed by page ID"},
  {"unitId": "apps/illuminator/webui/src/lib/db/relationshipRepository.ts::isRelationshipsSeeded", "purpose": "Checks whether relationships have already been seeded into the database for a given simulation run"},
  {"unitId": "apps/illuminator/webui/src/lib/db/relationshipRepository.ts::seedRelationships", "purpose": "Bulk-writes world relationship records into the database for a simulation run, stamping each with the run ID"},
  {"unitId": "apps/illuminator/webui/src/lib/db/relationshipRepository.ts::patchRelationships", "purpose": "Inserts only missing relationships for a simulation run by checking existing src/dst/kind keys, leaving duplicates untouched"},
  {"unitId": "apps/illuminator/webui/src/lib/db/relationshipRepository.ts::getRelationshipsForRun", "purpose": "Retrieves all relationship records persisted for a specific simulation run"},
  {"unitId": "apps/illuminator/webui/src/lib/db/relationshipRepository.ts::getRelationshipsForEntity", "purpose": "Fetches all relationships in which a specific entity participates either as source or destination within a simulation run"},
  {"unitId": "apps/illuminator/webui/src/lib/db/relationshipRepository.ts::deleteRelationshipsForRun", "purpose": "Deletes all relationship records associated with a simulation run from the database"},
  {"unitId": "apps/illuminator/webui/src/lib/db/schemaRepository.ts::getSchema", "purpose": "Retrieves the world schema record for a specific project from the database"},
  {"unitId": "apps/illuminator/webui/src/lib/db/schemaRepository.ts::upsertSchema", "purpose": "Creates or replaces the canon schema slice for a project in the database with an updated timestamp"},
  {"unitId": "apps/illuminator/webui/src/lib/db/slotRepository.ts::getSlot", "purpose": "Retrieves a simulation slot record by its project and slot index from the database"},
  {"unitId": "apps/illuminator/webui/src/lib/db/slotRepository.ts::upsertSlot", "purpose": "Creates or replaces a simulation slot record in the database"},
  {"unitId": "apps/illuminator/webui/src/lib/db/slotRepository.ts::deleteSlot", "purpose": "Removes a simulation slot record for a specific project and slot index from the database"},
  {"unitId": "apps/illuminator/webui/src/lib/db/staticPageRepository.ts::generatePageId", "purpose": "Generates a unique static page ID combining the current timestamp and a random UUID fragment"},
  {"unitId": "apps/illuminator/webui/src/lib/db/staticPageRepository.ts::generateSlug", "purpose": "Converts a page title into a URL-safe slug by lowercasing, removing special characters, and collapsing whitespace to hyphens"},
  {"unitId": "apps/illuminator/webui/src/lib/db/staticPageRepository.ts::extractEntityLinks", "purpose": "Scans markdown content for double-bracket entity link syntax and returns a deduplicated list of referenced entity names"},
  {"unitId": "apps/illuminator/webui/src/lib/db/staticPageRepository.ts::countWords", "purpose": "Counts the number of words in markdown content by stripping links, images, and formatting characters before splitting on whitespace"},
  {"unitId": "apps/illuminator/webui/src/lib/db/staticPageRepository.ts::createStaticPage", "purpose": "Creates a new static page record with a generated ID, slug, word count, and entity link list, then persists it to the database"},
  {"unitId": "apps/illuminator/webui/src/lib/db/staticPageRepository.ts::updateStaticPage", "purpose": "Applies title, content, summary, or status updates to an existing static page, recomputing slug, word count, and entity links as needed"},
  {"unitId": "apps/illuminator/webui/src/lib/db/staticPageRepository.ts::getStaticPage", "purpose": "Retrieves a single static page record by its ID from the database"},
  {"unitId": "apps/illuminator/webui/src/lib/db/staticPageRepository.ts::getStaticPagesForProject", "purpose": "Retrieves all static pages for a project sorted by most recently updated"},
  {"unitId": "apps/illuminator/webui/src/lib/db/staticPageRepository.ts::getPublishedStaticPagesForProject", "purpose": "Retrieves only the published static pages for a project, sorted by most recently updated"},
  {"unitId": "apps/illuminator/webui/src/lib/db/staticPageRepository.ts::deleteStaticPage", "purpose": "Permanently removes a single static page record from the database"},
  {"unitId": "apps/illuminator/webui/src/lib/db/staticPageRepository.ts::deleteStaticPagesForProject", "purpose": "Bulk-deletes all static pages for a project and returns the count removed"},
  {"unitId": "apps/illuminator/webui/src/lib/db/styleRepository.ts::loadStyleLibrary", "purpose": "Loads the persisted style library from the database, returning null if no custom library has been saved"},
  {"unitId": "apps/illuminator/webui/src/lib/db/styleRepository.ts::saveStyleLibrary", "purpose": "Persists a style library to the database with a save timestamp"},
  {"unitId": "apps/illuminator/webui/src/lib/db/styleRepository.ts::resetStyleLibrary", "purpose": "Removes the custom style library from the database, reverting to defaults"},
  {"unitId": "apps/illuminator/webui/src/lib/db/styleRepository.ts::getStyleLibrary", "purpose": "Retrieves the style library from the database, returning the default style library if no custom one has been saved"},
  {"unitId": "apps/illuminator/webui/src/lib/db/styleRepository.ts::hasCustomStyleLibrary", "purpose": "Returns whether the user has saved a custom style library, distinguishing user-modified from default styles"},
  {"unitId": "apps/illuminator/webui/src/lib/db/summaryRevisionRepository.ts::generateRevisionRunId", "purpose": "Generates a unique summary revision run ID combining the current timestamp and a random UUID fragment"},
  {"unitId": "apps/illuminator/webui/src/lib/db/summaryRevisionRepository.ts::createRevisionRun", "purpose": "Creates and persists a new summary revision run record with pending status, batches, context strings, and zeroed cost accumulators"},
  {"unitId": "apps/illuminator/webui/src/lib/db/summaryRevisionRepository.ts::getRevisionRun", "purpose": "Retrieves a single summary revision run record by its run ID from the database"},
  {"unitId": "apps/illuminator/webui/src/lib/db/summaryRevisionRepository.ts::updateRevisionRun", "purpose": "Applies partial field updates to an existing summary revision run record and saves it back to the database"},
  {"unitId": "apps/illuminator/webui/src/lib/db/summaryRevisionRepository.ts::deleteRevisionRun", "purpose": "Permanently removes a summary revision run record from the database"},
  {"unitId": "apps/illuminator/webui/src/lib/db/traitRepository.ts::getPalette", "purpose": "Retrieves the trait palette for a specific project and entity kind from the database"},
  {"unitId": "apps/illuminator/webui/src/lib/db/traitRepository.ts::savePalette", "purpose": "Persists a trait palette to the database with an updated timestamp"},
  {"unitId": "apps/illuminator/webui/src/lib/db/traitRepository.ts::updatePaletteItems", "purpose": "Applies item removals, merges, and additions to an existing trait palette and saves the result"},
  {"unitId": "apps/illuminator/webui/src/lib/db/traitRepository.ts::incrementPaletteUsage", "purpose": "Increments usage counts on palette items whose category or example words appear in the newly assigned trait strings"},
  {"unitId": "apps/illuminator/webui/src/lib/db/traitRepository.ts::registerUsedTraits", "purpose": "Records which visual traits were assigned to a specific entity in a simulation run for palette analysis and guidance generation"},
  {"unitId": "apps/illuminator/webui/src/lib/db/traitRepository.ts::getUsedTraitsForRun", "purpose": "Retrieves all trait usage records for a specific entity kind within a project and simulation run"},
  {"unitId": "apps/illuminator/webui/src/lib/db/traitRepository.ts::getHistoricalTraits", "purpose": "Returns a flat list of all trait strings ever used for a given entity kind across all simulation runs in a project"},
  {"unitId": "apps/illuminator/webui/src/lib/db/traitRepository.ts::countUsedTraits", "purpose": "Returns the total number of trait usage records for a given entity kind within a project"},
  {"unitId": "apps/illuminator/webui/src/lib/db/traitRepository.ts::getTraitGuidance", "purpose": "Selects trait palette categories appropriate for a given entity subtype and era, returning guidance for AI visual description generation"},
  {"unitId": "apps/illuminator/webui/src/lib/db/traitRepository.ts::deleteUsedTraitsForRun", "purpose": "Deletes all trait usage records for a specific project and simulation run, returning the count removed"},
  {"unitId": "apps/illuminator/webui/src/lib/db/traitRepository.ts::exportPalettes", "purpose": "Exports all trait palettes for a project as an array for backup or transfer"},
  {"unitId": "apps/illuminator/webui/src/lib/db/traitRepository.ts::importPalettes", "purpose": "Bulk-imports an array of trait palettes into the database, overwriting existing entries with matching IDs"},
  {"unitId": "apps/illuminator/webui/src/lib/preprint/contentTree.ts::createScaffold", "purpose": "Creates a default content tree structure with pre-built front matter, body, and back matter folder nodes for a new publication project"}
]
